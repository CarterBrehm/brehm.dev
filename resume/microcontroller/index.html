<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="University of Nebraska-Lincoln Department of Electrical and Computer Engineering Peter Kiewit Institute" />
  <title> image ECEN-433 Microprocessor Systems Design Final Report image Carter Brehm Spring 2024 </title>
   <meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta http-equiv="X-UA-Compatible" content="ie=edge" />
		<!-- <link rel="preload" href="./fonts/FiraGO-Regular.latin.woff2" as="font" crossorigin="anonymous"> -->
		<link href="../build.css" rel="stylesheet" />
  <style>
    body {
      margin: 0 auto;
      max-width: 75%;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
      line-height: 1.85;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
      font-size: revert;
      font-weight: revert;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>

</head>

<body class="font-firago">
<header id="title-block-header">
<h1 class="title"> <img src="Picture1.png" alt="image" /><br />
ECEN-433<br />
Microprocessor Systems Design<br />
Final Report<br />
<img src="sharif.jpg" style="width:12cm" alt="image" /><br />
Carter Brehm<br />
Spring 2024<br /></h1>
<p class="author">University of Nebraska-Lincoln<br />
Department of Electrical and Computer Engineering<br />
Peter Kiewit Institute</p>
</header>
<h1 id="summary">Summary</h1>
<p>This lab explored the process of planning, designing, building, and
programming a computer system with a variety of memory and I/O devices.
The goal is to serve as a manifestation of concepts taught in lecture
such as memory organization and types of electronic communication. At
the end of this lab, a full computer system was demonstrated with all of
the composite functionality of each of the previous labs given in the
course.</p>
<p>This report is divided into logical sections. The
<strong>Objective</strong> provides a holistic overview of the lab,
including several key deliverables. The <strong>Introduction</strong>
provides background information, theories, or specialized hardware and
tools required to understand the lab procedures. The <strong>Hardware
Discussion</strong> reviews both the schematic and generated circuit
board, as well as describing relationships within. The <strong>Software
Discussion</strong> discusses each piece of software functionality
provided by the system, as well as explaining program flow. The
<strong>Problem Discussion</strong> provides a look into several
problems encountered during lab, and how they were fixed or worked
around. The <strong>Conclusion</strong> has some final thoughts
regarding the entire project. Finally, the <strong>Appendix</strong>
contains all code and other artifacts required to reproduce the lab.</p>
<h1 id="objective">Objective</h1>
<p>The desired outcome of this lab was a microprocessor computer system
using the 8051 platform to run RAM functions defined in Labs 1-4. The
system would take user input via two methods: directly via the attached
keypad, and serially from the attached ESP8266â€™s web server. The output
includes a high-quality LCD display as well as a 7-segment display. Each
of the success criterion are enumerated specifically below (drawn from
lab handouts):</p>
<ol>
<li><p>The microprocessor platform used in the design shall be the
AT89C51RC.</p></li>
<li><p>The microprocessor shall use a memory decoding scheme to
interface with 64K of ROM as well as 64K of RAM.</p></li>
<li><p>The microprocessor shall communicate with several I/O
devices:</p>
<ol>
<li><p>16 button matrix keypad</p></li>
<li><p>7-segment common cathode display</p></li>
<li><p>2.8" TFT LCD</p></li>
<li><p>Real-time clock</p></li>
<li><p>Analog to digital converter</p></li>
<li><p>ESP-8266</p></li>
</ol></li>
<li><p>The code must implement and support the following RAM
functionality:</p>
<ol>
<li><p>Check</p></li>
<li><p>Dump</p></li>
<li><p>Move</p></li>
<li><p>Find</p></li>
<li><p>Edit</p></li>
<li><p>Count</p></li>
</ol></li>
</ol>
<p>Once these functionalities were completed, they would be demonstrated
to the lab TA for project completion.</p>
<h1 id="introduction">Introduction</h1>
<p>During research for this project, some concepts became vital to
complete the lab.</p>
<h2 id="address-latching">Address Latching</h2>
<p>The 8051 has the ability to address 64K of memory using 16 address
lines, but half of the lines (AD0-AD7) are multiplexed with the incoming
data bus, and must be demultiplexed before being able to use either
bus.</p>
<p>This is done with the addition of a small address latch. The 8051
provides an ALE signal to indicate whether itâ€™s intending to send a
16-bit address using all 16 lines, or receive 8 bits of data through the
8 data lines. This signal can be fed to the latch to hold address lines
high when data is being received, and to pass them through to the
controller when itâ€™s calling an address.</p>
<h2 id="serial-vs.-parallel-communication">Serial vs. Parallel
Communication</h2>
<p>In this lab, both serial and parallel communication were used in
different areas for different reasons.</p>
<h3 id="parallel">Parallel</h3>
<p>As discussed above, address and data fetching used parallel
communication across the board. Having a wide bus made communication
quick and simple, as the minimum unit of data was a byte. The
disadvantages were the amount of lines required (which became slightly
unruly during routing) as well as the requirement of multiple components
sharing a data bus. This issue was solved using a GAL decoder, which
served as a meta-addressor and only activate the specific chip being
addressed. This would keep the data bus clear for communication.</p>
<h3 id="serial">Serial</h3>
<p>Serial communication was added on to the board as an example of
communicating with hardware that used a more standardized communication
protocol (in this case, RS232). In most cases, parallel communication is
cost-prohibitive or impossible, so serial communication is possible with
only two lines.</p>
<h2 id="sdcc">SDCC</h2>
<p>SDCC (small device C compiler) was used extensively during the lab to
assemble and compile C code into 8051 assembly. SDCC differs from other
C compilers (like those on the desktop) by allowing the developer to
choose where in memory (or on external hardware, such as the ROM chips)
each variable or constant was stored. This allowed for optimization for
specific routines. For example, a section of internal RAM was designated
specifically to hold incoming serial, to avoid having to make a trip out
to the external memory during a serial interrupt. This was also used to
fit image data onto the second ROM specifically, to keep it separate
from the rest of code memory.</p>
<h1 id="hardware-discussion">Hardware Discussion</h1>
<figure id="schematic-power">
<img src="schematics/power.png" style="width:5in" />
<figcaption>Connection began at the DC barrel jack connector, which took
in DC 5V and spread ground and VCC throughout the board via planes to
simplify wiring.</figcaption>
</figure>
<figure id="schematic-8051">
<img src="schematics/8051.png" style="width:5in" />
<figcaption>The 8051 sat at the top of the circuit hierarchy as it
controlled all operation. Through port 0 and port 2, it sent and
received addresses and data, using PSEN, ALE, and IO/M to control
decoding and addressing individual chips.</figcaption>
</figure>
<figure id="schematic-crystal">
<img src="schematics/crystal.png" style="width:5in" />
<figcaption>The 8051 has no internal clock, so an external crystal was
provided and connect to the controllerâ€™s XTAL1 clock input to tick the
circuit.</figcaption>
</figure>
<figure id="schematic-pal">
<img src="schematics/pal.png" style="width:5in" />
<figcaption>For decoding, the signals shown in the figure were used to
decode a single chip selection signal that would use the data and
address bus.</figcaption>
</figure>
<figure id="schematic-address_latch">
<img src="schematics/address_latch.png" style="width:5in" />
<figcaption>In addition to the PAL, the address latch was also essential
for decoding. With the help of the ALE signal, it would latch the bottom
half of the address lines at their current value, allowing data
reception from a specific address.</figcaption>
</figure>
<figure id="schematic-rom">
<img src="schematics/rom.png" style="width:5in" />
<figcaption>Once the address and data lines have been demultiplexed,
they can be sent to the ROM. Since the ROM is only half of the memory
space, the A15 signal is only used to decode chip select, and isnâ€™t
provided to the ROM. The emitted data is sent back through the data bus
while the reading address is held. WR is held high to avoid accidentally
overwriting code memory.</figcaption>
</figure>
<figure id="schematic-ram">
<img src="schematics/ram.png" style="width:5in" />
<figcaption>Similarly to the ROM, the RAM is governed by the PAL
decoder, receives all but one address line from the controller, emitting
its data back to the data bus.</figcaption>
</figure>
<figure id="schematic-lcd">
<img src="schematics/lcd.png" style="width:5in" />
<figcaption>The LCD has a built-in controller, which simplified drawing
to the screen. Less lines had to be connected back to the main
controller. The LCD could be selected via decoding/addressing, and
controlled by sending data in parallel through D0-D7. The alternative
SPI mode was not used.</figcaption>
</figure>
<figure id="schematic-keypad">
<img src="schematics/keypad.png" style="width:5in" />
<figcaption>The 4x4 matrix keypad had no controller, and thus must be
decoded manually by the 8051. It was connected directly to port 1, and
rows/columns of the matrix would be flashed to decode user
input.</figcaption>
</figure>
<p>.</p>
<figure id="schematic-7seg">
<img src="schematics/7seg.png" style="width:5in" />
<figcaption>The 7-segment display must have the ability to hold itâ€™s
value, which means another latch had to be used. The latch could be
selected via decoding scheme and pass through a value to hold on the
display. This was usually the number pressed on the keypad.</figcaption>
</figure>
<figure id="schematic-adc">
<img src="schematics/adc.png" style="width:5in" />
<figcaption>The ADC was connected as another generic I/O device, in
which the decoding was used to select the chip so the data bus could be
used to receive incoming data. In this case, measurements were made by
selecting the chip, and reading the 8bit voltage value as a ratio of
VCC.</figcaption>
</figure>
<figure id="schematic-rtc">
<img src="schematics/rtc.png" style="width:5in" />
<figcaption>The RTC was connected in the same manner as other I/O
devices. It could be selected via decoding at a specific set of
addresses, in which there were several registers holding year, month,
etc. These values could be sent back over the data bus. A small
coin-cell battery was attached to keep accurate time while the circuit
is powered down.</figcaption>
</figure>
<figure id="schematic-esp_and_led">
<img src="schematics/esp_and_led.png" style="width:5in" />
<figcaption>Finally, the ESP was connected serially, using a voltage
transformer to step down to 3V. RX and TX were swapped on their way to
the board because both elements of the communication were terminal
equipment.</figcaption>
</figure>
<figure id="breadboard">
<img src="breadboard.jpeg" style="width:5in" />
<figcaption>The final prototype made on the breadboard. This did not
include the ESP, which was held until the final board design to avoid
complication.</figcaption>
</figure>
<p>.</p>
<h1 id="software-discussion">Software Discussion</h1>
<h2 id="function-blocks-or-modules">Function Blocks or Modules</h2>
<p>For this lab, the code was divided into logical groupings based off
functionality. Each of these logical groupings are explained in detail
below.</p>
<h3 id="main">Main</h3>
<p>The main module is where main program flow resides in the program.
First, an interrupt is scheduled (explained further in Serial). Once the
LCD, clock, and serial communication have been initialized, all
functionality is delegated to other modules. The main function calls the
menu whenever no other functionality is happening (on boot, and after
exiting another menu) and calls the function depending on the user
input.</p>
<h3 id="menu">Menu</h3>
<p>The menu module is used to present options to the user. The main menu
prints out a list of predefined menu options, waits for the user to
press a key, validates that it is within the bounds of available
options, then finally returns the chosen option as an exit code. This
allows for the main module to call the correct functionality.</p>
<p>The other menu defined in the menu module is to choose block size.
Multiple different functionalities featured elsewhere in the program
take a block size for their datatype, and this functionality was
collected into the block size menu function. Just as the main menu, the
program lists out the possible block sizes and returns the userâ€™s choice
to the calling function.</p>
<p>Finally, the menu module is also responsible for printing the intro
screen and updating the clock when the system boots.</p>
<h3 id="lcd">LCD</h3>
<p>The LCD driver was provided as a part of the lab materials as a means
to control the LCD display. These functions include printing text,
shapes like circles and squares, as well as housekeeping functions such
as clearing the display or manipulating the cursor.</p>
<p>One interesting implementation detail of the LCD library is a
maintained state within the library that can be accessed from other
libraries. For example, the <code>cursor_x</code> variable, containing
the cursorâ€™s current x position, has a static position in internal RAM.
Then, instead of querying for the cursor position from the LCD, external
libraries can call the <code>getCursorX()</code> function to determine
where they are drawing on the screen.</p>
<p>The LCD driver also contains the pixel data for the picture, as well
as the code to display it. The pixel data is encoded as an array of
16bit RGB565 values, and printed row-by-row as a set of 2x2 squares
(resulting in a 2x upscaling of a 160x120 image).</p>
<h3 id="keypad">Keypad</h3>
<p>The keypad library collects functions that revolve around the keypad
(or user input in general). It provides both a blocking and non-blocking
function for getting the button the user pressed on the keypad, whether
the calling function needs to determine the user isnâ€™t pressing a key,
or wait for them to do so.</p>
<p>The keypad library also includes prompting functions, which use the
LCD to prompt the user for a byte or word in hex, taking care of
sanitization and conversion before the calling function receives the hex
input. The library also contains stubs for inserting serial input (from
the ESP virtual keypad) into the regular keypad input routines.</p>
<h3 id="utils">Utils</h3>
<p>The utilities library contains helper functions that are utilized by
almost all libraries. The first is a pair of functions to print hex
characters to the display given a byte or a word. This function is used
everywhere when needing to translate an address or piece of data to the
user.</p>
<p>The second is a set of generic I/O write routines. These helper
functions make sure that the IO/M pin is set correctly when addressing
I/O devices, since the 8051 does not have hardware support for this
pin.</p>
<h3 id="constants">Constants</h3>
<p>Predictably, the constants library contains no executable code,
instead holding lookup tables for ASCII and 7-segment decoding, as well
as menu options for the menu library.</p>
<h3 id="segment">Segment</h3>
<p>The segment library contains functions for interacting with the
7-segment display on the board. The library can draw a character (this
is used in the keypad library to echo the userâ€™s input) or display a
small moving animation (this is used to show the board is powering
on).</p>
<h3 id="memory">Memory</h3>
<p>The memory module is used to provide helper functions to the other
memory manipulation functions like Count and Find. The module provides
generic â€˜readFromExternalAddress()â€˜ and â€˜writeToExternalAddress()â€˜ so
that the calling function doesnâ€™t have to perform the assembly
operations required to move the data pointer. The library also provides
functions to page through (forward or backward) memory, finding or
counting</p>
<h3 id="adc">ADC</h3>
<p>The ADC module is responsible for interfacing with the ADC. Since ADC
functionality is limited in the current form of the system, this module
is only responsible for printing the ADC menu as well as the current
read voltage value.</p>
<h3 id="count">Count</h3>
<p>The count module is responsible for controlling the count menu and
functionality. It prompts the user for the necessary inputs and then
performs the count operation. The user is presented with the report
depending on the returned results. At the end, the user can choose to
jump into the find routine with the current arguments to show the
location of the counted values.</p>
<h3 id="find">Find</h3>
<p>The find module is responsible for the find menu and the actual
finding operations. The find module is split into three layers, the find
menu, the find operation, and the find page in which the results are
displayed.</p>
<p>The find menu is how the user normally accesses find, from the main
menu. It prompts the user for the neccessary inputs and then jumps into
the find operation.</p>
<p>The find operation uses the memory library to scan forward and
backward for the userâ€™s selected value. To avoid holding too many found
values in memory, this operation stops once it has reached the specified
value, and displays it in the find page. The find operation is
abstracted from the menu in cases where another function (like count)
needs to jump right into finding the value it just displayed to the
user. This avoids prompting the user again for the same information.</p>
<p>The find page takes the found value at a specific address and
displays it to the user. Then, it searches forward and backward for
another address to jump to, giving the user a previous and next page
option if available.</p>
<h3 id="dump">Dump</h3>
<p>The dump module works in a similar manner to the find module. It asks
for the required information through the keypad, then reads that section
of memory and passes it to the dump page.</p>
<p>The dump page prints the current address and value to the screen,
then does a bounds check for the chosen bounds as well as the start
&amp; end of memory to give the user previous and next page indicators
so they can scroll to see a new page of memory.</p>
<h3 id="edit">Edit</h3>
<p>The edit module is responsible for guiding the user to editing a
section of memory with the keypad. The function will first prompt the
user for the required address to edit, then pass that to an edit
page.</p>
<p>An edit page will display the current address and the values to be
edited, then let the user type over the displayed values to overwrite
the actual memory location. Once this value is entered, the edit page
will return this new edited value.</p>
<p>Stepping out of the page, the edit function will write the user value
to memory and prompt the user to either go to the next byte to edit or
return to the menu.</p>
<h3 id="move">Move</h3>
<p>The move module is responsible for the move menu as well as the
memory move operation. It will prompt the user for required input such
as source and destination, perform error checks to ensure the move is
logical, and finally run through a simple loop to move values from
source to destination.</p>
<h3 id="ramcheck">RamCheck</h3>
<p>The RamCheck module is responsible for performing the RAM check
across all of the memory space. First, it prompts the user for a byte to
write, which it passes to a set of inline assembly functions which write
and check the entire memory chip with the value. If that succeeds, the
module will invert the value and run again, printing the status out to
the user.</p>
<h3 id="rtc">RTC</h3>
<p>The RTC module is responsible for controlling the RTC and providing
its value to the rest of the system (eg. the title screen). The module
contains functions for encoding and decoding date/time values back and
forth from the RTC. It also contains the RTC menu, which allows the user
to view the current time as well as edit it, using helper functions to
convert user input into the correct values to be placed in the RTC
registers.</p>
<h3 id="serial-1">Serial</h3>
<p>The Serial module contains only one function, the initialization of
the serial port on the 8051 to the correct baud rate. SDCC dictated that
the serial interrupt must be included in the main module to be compiled
and placed in the interrupt vector table.</p>
<h2 id="sequential-diagram-for-program">Sequential Diagram for
Program</h2>
<figure id="flowchart-menu">
<img src="flowcharts/main.png" style="width:8in" />
<figcaption>Top-level flowchart of the entire program. The menu
functions as a computing layer, allowing the user to call up
functionality that takes complete control until the user chooses to
exit.</figcaption>
</figure>
<figure id="flowchart-ramcheck">
<img src="flowcharts/ramcheck.png" style="width:2in" />
<figcaption>Showing program flow of the RAM check.</figcaption>
</figure>
<figure id="flowchart-dump">
<img src="flowcharts/dump.png" style="width:2in" />
<figcaption>Showing program flow of the dump function.</figcaption>
</figure>
<figure id="flowchart-edit">
<img src="flowcharts/edit.png" style="width:2in" />
<figcaption>Showing program flow of the edit function.</figcaption>
</figure>
<figure id="flowchart-count">
<img src="flowcharts/count.png" style="width:2in" />
<figcaption>Showing program flow of the count function.</figcaption>
</figure>
<figure id="flowchart-find">
<img src="flowcharts/find.png" style="width:3in" />
<figcaption>Showing program flow of the find function.</figcaption>
</figure>
<figure id="flowchart-move">
<img src="flowcharts/move.png" style="width:4in" />
<figcaption>Showing program flow of the move function.</figcaption>
</figure>
<h1 id="problem-discussion">Problem Discussion</h1>
<p>Throughout this project, most problems were transient, and fixed with
a quick continuity test or recompile. However, there were some problems
that plagued the project for multiple lab sessions.</p>
<h2 id="decoding-issues">Decoding Issues</h2>
<p>Early on in development, in the breadboarding stage, an issue arose
in which the circuit would appear to turn on correctly after reset, but
would quickly stop functioning soon after without doing anything. Each
component was tested, but with each piece of evidence the conclusion was
that the processor simply stopped issuing commands soon after boot-up.
The chip selection for ROM would stop selecting, and the system would
simply freeze.</p>
<p>The solution ended up being to change the decoding. In error, the
decoding for the ROM chip select had included IO/M. Due to this error,
each time the chip would switch that pin to attempt to access an I/O
device, it would lose access to its ROM and cease function.</p>
<h2 id="debouncing">Debouncing</h2>
<p>The keypad used in this project had a lot of issues, most of which
were related to noise and debouncing. Essentially, input from the keypad
could rarely be trusted, as noise through the lines would press several
"phantom" keys immediately after.</p>
<p>The solution to this was to add a delay to the non-blocking keypad
read before taking any more input. This would allow the noise to subside
and</p>
<h1 id="conclusion">Conclusion</h1>
<p>Throughout the course, all of the design lectures and labs built
towards one final system. This system was planned, designed, prototypes
on the breadboard, and finally manufactured on a printed circuit board.
It began with conceptual labs, writing assembly and later C code
targeted against an 8051 simulator. As the lectures turned to systems
design, the board began to take shape, finalizing a decoding and
operation schema. Finally, the course pivoted to PCB design, and the
final output of the lab depended heavily on oneâ€™s design and
routing.</p>
<p>I could be considered lucky in that my board was routed well enough
that I had to make no corrections to my final printed board. I learned a
lot about designing a system from the ground up, using my preliminary
theoretical knowledge of gates and logic to slowly construct a device
that computes. I learned about how to troubleshoot efficiently, learning
about the expected output of each part and dialing-in debugging on
pieces that didnâ€™t, making each issue an exercise in precision. I
learned that while continuing to add pieces on and onto a system works,
having a plan and executing it top-to-bottom extensively makes for an
easier process. Finally, I learned about all of the ways that machine
code can be converted and executed by a system, as well as the
advantages and disadvantages of each.</p>
<p>Overall, I had much success in the course and greatly enjoyed the
process. There were definitely difficulties, in which troubleshooting
seemed daunting. How could I possibly figure out whatâ€™s wrong, without
seeing the internals of the entire system at the same time? I learned
skills to help me work through this paralysis and deduce how to move
towards "better," not necessarily jumping to perfect.</p>
<h1 id="appendix">Appendix</h1>
<h2 id="pcb-design">PCB Design</h2>
<figure id="pcb-bottom-only">
<img src="pcb/bottom-only.png" style="width:6in" />
<figcaption>Finalized PCB design with only the bottom layer
showing.</figcaption>
</figure>
<p>.</p>
<figure id="pcb-top-only">
<img src="pcb/top-only.png" style="width:6in" />
<figcaption>Finalized PCB design with only the top layer
showing.</figcaption>
</figure>
<figure id="pcb-both">
<img src="pcb/both.png" style="width:6in" />
<figcaption>Finalized PCB design with both layers and vias
showing.</figcaption>
</figure>
<h2 id="bill-of-materials">Bill of Materials</h2>
<h2 id="demo-images">Demo Images</h2>
<figure id="demo-title">
<img src="demo/title.png" style="width:3in" />
<figcaption>Title screen that is displayed when the circuit is first
reset, that displays author details and live date &amp;
time.</figcaption>
</figure>
<figure id="demo-menu">
<img src="demo/menu.png" style="width:3in" />
<figcaption>Menu screen that displays after the user dismisses the title
screen. Allows for jumping to any of the other
functionality.</figcaption>
</figure>
<figure id="demo-ramcheck">
<img src="demo/ramcheck.png" style="width:3in" />
<figcaption>Performing a RAM check on the device and reading back
successful debug info.</figcaption>
</figure>
<figure id="demo-count">
<img src="demo/count.png" style="width:3in" />
<figcaption>Counting the instances of a specific hex value through all
RAM.</figcaption>
</figure>
<figure id="demo-dump">
<img src="demo/dump.png" style="width:3in" />
<figcaption>Dumping a section of RAM to the display in hex.</figcaption>
</figure>
<figure id="demo-edit">
<img src="demo/edit.png" style="width:3in" />
<figcaption>Editing the value of a specific byte in RAM.</figcaption>
</figure>
<figure id="demo-rtc">
<img src="demo/rtc.png" style="width:3in" />
<figcaption>Editing the time stored in the real-time clock from the
keypad.</figcaption>
</figure>
<figure id="demo-move">
<img src="demo/move.png" style="width:3in" />
<figcaption>Moving the values from one section of RAM into another
section.</figcaption>
</figure>
<figure id="demo-adc">
<img src="demo/adc.png" style="width:3in" />
<figcaption>Reading the voltage of a connected analog
signal.</figcaption>
</figure>
<figure id="demo-fry">
<img src="demo/fry.png" style="width:3in" />
<figcaption>Displaying an image on the screen from code
memory.</figcaption>
</figure>
<h2 id="implementation-code-for-microprocessor">Implementation Code for
Microprocessor</h2>
<div class="sourceCode" id="cb1" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">// including standard headers and portable datatypes</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;8051.h&quot;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;LCD.h&quot;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Constants.h&quot;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Bool.h&quot;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;RamCheck.h&quot;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Utils.h&quot;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Menu.h&quot;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Dump.h&quot;</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Move.h&quot;</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Find.h&quot;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Edit.h&quot;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Count.h&quot;</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Memory.h&quot;</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Keypad.h&quot;</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Segment.h&quot;</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;include/LCD.h&quot;</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;main.h&quot;</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;RTC.h&quot;</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;ADC.h&quot;</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Serial.h&quot;</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> serial_receive_interrupt<span class="op">(</span><span class="dt">void</span><span class="op">)</span> __interrupt <span class="op">(</span><span class="dv">4</span><span class="op">)</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>	<span class="dt">volatile</span> <span class="dt">uint8_t</span> data <span class="op">=</span> SBUF<span class="op">;</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>	setSerialData<span class="op">(</span>data<span class="op">);</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>	SCON <span class="op">&amp;=</span> <span class="op">~(</span><span class="dv">1</span><span class="op">&lt;&lt;</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span><span class="op">;</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>	AUXR <span class="op">=</span> <span class="bn">0x02</span><span class="op">;</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>	serialInit<span class="op">();</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>	loadingLoop<span class="op">(</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>	initLCD<span class="op">();</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>	<span class="co">// rtcInit();</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>	setRotation<span class="op">(</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>	setTextSize<span class="op">(</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>	setTextColor<span class="op">(</span>WHITE<span class="op">,</span> GREEN<span class="op">);</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>	clearLCD<span class="op">();</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>	titleScreen<span class="op">();</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>	<span class="cf">while</span> <span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>		<span class="dt">uint8_t</span> choice <span class="op">=</span> menu<span class="op">();</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>		<span class="cf">switch</span> <span class="op">(</span>choice<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>			<span class="cf">case</span> <span class="bn">0x0A</span><span class="op">:</span> <span class="co">// RAM Check</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>				ramCheck<span class="op">();</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>				<span class="cf">break</span><span class="op">;</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>			<span class="cf">case</span> <span class="bn">0x0B</span><span class="op">:</span> <span class="co">// Move</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>				move<span class="op">();</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>				<span class="cf">break</span><span class="op">;</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>			<span class="cf">case</span> <span class="bn">0x0C</span><span class="op">:</span> <span class="co">// Count</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>				count<span class="op">();</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>				<span class="cf">break</span><span class="op">;</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>			<span class="cf">case</span> <span class="bn">0x0D</span><span class="op">:</span> <span class="co">// Dump</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>				dump<span class="op">();</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>				<span class="cf">break</span><span class="op">;</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>			<span class="cf">case</span> <span class="bn">0x0E</span><span class="op">:</span> <span class="co">// Edit</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>				edit<span class="op">();</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>				<span class="cf">break</span><span class="op">;</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>			<span class="cf">case</span> <span class="bn">0x0F</span><span class="op">:</span> <span class="co">// Find</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>				find<span class="op">();</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>				<span class="cf">break</span><span class="op">;</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>			<span class="cf">case</span> <span class="bn">0x01</span><span class="op">:</span> <span class="co">// Clock</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>				rtcMenu<span class="op">();</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>				<span class="cf">break</span><span class="op">;</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>			<span class="cf">case</span> <span class="bn">0x02</span><span class="op">:</span> <span class="co">// ADC</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>				adcMenu<span class="op">();</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>				<span class="cf">break</span><span class="op">;</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>			<span class="cf">case</span> <span class="bn">0x03</span><span class="op">:</span> <span class="co">// Fry</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>				fryScreen<span class="op">();</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>				<span class="cf">break</span><span class="op">;</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb2" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#ifndef MAIN_H</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MAIN_H</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;8051.h&quot;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>__sfr __at<span class="op">(</span><span class="bn">0x8E</span><span class="op">)</span> AUXR<span class="op">;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span></code></pre></div>
<div class="sourceCode" id="cb3" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;ADC.h&quot;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Constants.h&quot;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;LCD.h&quot;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Keypad.h&quot;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Utils.h&quot;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> adcMenu<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>	readKeypad<span class="op">();</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;Reading voltage...&quot;</span><span class="op">);</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">7</span><span class="op">,</span> <span class="dv">216</span><span class="op">);</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;&lt;E Exit (hold)&quot;</span><span class="op">);</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> keypadIndex <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>	<span class="cf">while</span> <span class="op">(</span>keypadIndex <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>		setCursor<span class="op">(</span><span class="dv">130</span><span class="op">,</span> <span class="dv">120</span><span class="op">);</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>		adcPrint<span class="op">();</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>		keypadIndex <span class="op">=</span> readKeypad<span class="op">();</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> adcPrint<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> adcVal<span class="op">;</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> adcVoltageVal<span class="op">;</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>	adcVal <span class="op">=</span> ioread8<span class="op">((</span><span class="dt">uint8_t</span> __xdata<span class="op">*)</span> <span class="bn">0xC000</span><span class="op">);</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>	adcVoltageVal <span class="op">=</span> <span class="op">(</span>adcVal <span class="op">*</span> <span class="dv">500</span><span class="op">)</span> <span class="op">/</span> <span class="dv">255</span><span class="op">;</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span>asciiLookup<span class="op">[</span>adcVoltageVal <span class="op">/</span> <span class="dv">100</span><span class="op">]);</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;.&quot;</span><span class="op">);</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span>asciiLookup<span class="op">[</span>adcVoltageVal <span class="op">%</span> <span class="dv">10</span><span class="op">]);</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;V&quot;</span><span class="op">);</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb4" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Constants.h&quot;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>__code <span class="dt">char</span> asciiLookup<span class="op">[</span><span class="dv">17</span><span class="op">]</span> <span class="op">=</span> <span class="st">&quot;0123456789ABCDEF&quot;</span><span class="op">;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>__code <span class="dt">char</span> menuCount <span class="op">=</span> <span class="dv">8</span><span class="op">;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>__code <span class="dt">char</span><span class="op">*</span> menuOptions<span class="op">[</span><span class="dv">8</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="st">&quot;A | RAM Check&quot;</span><span class="op">,</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a> 			       <span class="st">&quot;B | Move&quot;</span><span class="op">,</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>           		   <span class="st">&quot;C | Count&quot;</span><span class="op">,</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>			       <span class="st">&quot;D | Dump&quot;</span><span class="op">,</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>			       <span class="st">&quot;E | Edit&quot;</span><span class="op">,</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>			       <span class="st">&quot;F | Find&quot;</span><span class="op">,</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>			       <span class="st">&quot;1 | Clock&quot;</span><span class="op">,</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>			       <span class="st">&quot;2 | ADC&quot;</span><span class="op">};</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>__code <span class="dt">char</span> blockSizeMenuCount <span class="op">=</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>__code <span class="dt">char</span><span class="op">*</span> blockSizeMenuOptions<span class="op">[</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="st">&quot;A     Byte      &quot;</span><span class="op">,</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>					<span class="st">&quot;B     Word      &quot;</span><span class="op">,</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>					<span class="st">&quot;C Double  Word  &quot;</span><span class="op">,</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>					<span class="st">&quot;D  Quad  Word   &quot;</span><span class="op">};</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>__code <span class="dt">char</span> segconvert<span class="op">[</span><span class="dv">16</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="bn">0x3F</span><span class="op">,</span> <span class="bn">0x06</span><span class="op">,</span> <span class="bn">0x5B</span><span class="op">,</span> <span class="bn">0x4F</span><span class="op">,</span> <span class="bn">0x66</span><span class="op">,</span> <span class="bn">0x6D</span><span class="op">,</span> <span class="bn">0x7D</span><span class="op">,</span> <span class="bn">0x07</span><span class="op">,</span> <span class="bn">0x7F</span><span class="op">,</span> <span class="bn">0x6F</span><span class="op">,</span>  <span class="bn">0x77</span><span class="op">,</span> <span class="bn">0x7C</span><span class="op">,</span> <span class="bn">0x39</span><span class="op">,</span> <span class="bn">0x5E</span><span class="op">,</span> <span class="bn">0x79</span><span class="op">,</span> <span class="bn">0x71</span><span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb5" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">// associated header file</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Count.h&quot;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">// including standard headers and portable datatypes</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;8051.h&quot;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;LCD.h&quot;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Keypad.h&quot;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Utils.h&quot;</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Bool.h&quot;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Memory.h&quot;</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Find.h&quot;</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> count<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint16_t</span> startAddress <span class="op">=</span> promptForWord<span class="op">(</span><span class="st">&quot;Count Address?&quot;</span><span class="op">);</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint16_t</span> blockQuantity <span class="op">=</span> promptForWord<span class="op">(</span><span class="st">&quot;Byte Quantity?&quot;</span><span class="op">);</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> searchValue <span class="op">=</span> promptForByte<span class="op">(</span><span class="st">&quot;Count Value?&quot;</span><span class="op">);</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>	<span class="co">// quick check to make sure they didn&#39;t want zero blocks</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>	<span class="cf">while</span> <span class="op">(!</span>blockQuantity<span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>		blockQuantity <span class="op">=</span> promptForWord<span class="op">(</span><span class="st">&quot;Quantity &gt; 0!&quot;</span><span class="op">);</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>	<span class="co">// quick check to see if we will overflow address</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> <span class="op">(</span>startAddress <span class="op">+</span> blockQuantity <span class="op">&lt;</span> startAddress<span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>		blockQuantity <span class="op">=</span> promptForWord<span class="op">(</span><span class="st">&quot;Overflow! Try less blocks.&quot;</span><span class="op">);</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>		<span class="cf">return</span><span class="op">;</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>	clearLCD<span class="op">();</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;Counting 0x&quot;</span><span class="op">);</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>	printHexByteToASCIIArray<span class="op">(</span>searchValue<span class="op">);</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;...&quot;</span><span class="op">);</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>	<span class="co">// iterate through memory using searchForwardForExternalValue</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>	<span class="co">// every time we find an address, increment a counter and then search again from the next address</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint16_t</span> currentAddress <span class="op">=</span> startAddress<span class="op">;</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint16_t</span> endAddress <span class="op">=</span> startAddress <span class="op">+</span> blockQuantity<span class="op">;</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> count <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>	count <span class="op">=</span> countValueInRange<span class="op">(</span>startAddress<span class="op">,</span> endAddress<span class="op">,</span> searchValue<span class="op">);</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">35</span><span class="op">);</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;Matches: &quot;</span><span class="op">);</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>	printHexByteToASCIIArray<span class="op">(</span>count<span class="op">);</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">216</span><span class="op">);</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> <span class="op">(</span>count<span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>		printString<span class="op">(</span><span class="st">&quot;&lt;E Exit           View 1&gt;&quot;</span><span class="op">);</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>		<span class="dt">uint8_t</span> choice <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>		<span class="cf">if</span> <span class="op">(</span>choice <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>			findArgs<span class="op">(</span><span class="dv">0</span><span class="op">,</span> blockQuantity<span class="op">,</span> searchValue<span class="op">);</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>		printString<span class="op">(</span><span class="st">&quot;&lt;E Exit                 |&quot;</span><span class="op">);</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>		waitForKeypad<span class="op">();</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span><span class="op">;</span></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb6" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">// associated header file</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Dump.h&quot;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">// including standard headers and portable datatypes</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;8051.h&quot;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;LCD.h&quot;</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Keypad.h&quot;</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Utils.h&quot;</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Memory.h&quot;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Menu.h&quot;</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> dumpPage<span class="op">(</span><span class="dt">uint16_t</span> address<span class="op">,</span> <span class="dt">uint8_t</span> byteCount<span class="op">,</span> <span class="dt">bool</span> pagesBefore<span class="op">,</span> <span class="dt">bool</span> pagesAfter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;Dumping... E to exit&quot;</span><span class="op">);</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>	<span class="co">// back indicator</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">7</span><span class="op">,</span> <span class="dv">216</span><span class="op">);</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> <span class="op">(</span>pagesBefore<span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>		printString<span class="op">(</span><span class="st">&quot;&lt;1&quot;</span><span class="op">);</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>		printString<span class="op">(</span><span class="st">&quot;| &quot;</span><span class="op">);</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>	<span class="co">// current memory address</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">120</span><span class="op">,</span> <span class="dv">216</span><span class="op">);</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;0x&quot;</span><span class="op">);</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>	printHexWordToASCIIArray<span class="op">(</span>address<span class="op">);</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>	<span class="co">// next indicator</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">295</span><span class="op">,</span> <span class="dv">216</span><span class="op">);</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> <span class="op">(</span>pagesAfter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>		printString<span class="op">(</span><span class="st">&quot;0&gt;&quot;</span><span class="op">);</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>		printString<span class="op">(</span><span class="st">&quot; |&quot;</span><span class="op">);</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>	<span class="co">// data at memory location</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">150</span> <span class="op">-</span> byteCount<span class="op">*</span><span class="dv">12</span><span class="op">,</span> <span class="dv">120</span><span class="op">);</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>	<span class="cf">while</span> <span class="op">(</span>byteCount <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>		printHexByteToASCIIArray<span class="op">(</span>readFromExternalAddress<span class="op">(</span>address<span class="op">));</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>		byteCount<span class="op">--;</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>		address<span class="op">++;</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>	<span class="cf">while</span> <span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>		<span class="dt">uint8_t</span> pageChoice <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>		<span class="cf">if</span> <span class="op">((</span>pageChoice <span class="op">==</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> pagesAfter<span class="op">)</span> <span class="op">||</span> <span class="op">(</span>pageChoice <span class="op">==</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> pagesBefore<span class="op">)</span> <span class="op">||</span> pageChoice <span class="op">==</span> <span class="bn">0x0E</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> pageChoice<span class="op">;</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dump<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint16_t</span> startAddress <span class="op">=</span> promptForWord<span class="op">(</span><span class="st">&quot;Dump Address?&quot;</span><span class="op">);</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> blockSize <span class="op">=</span> blockSizeMenu<span class="op">();</span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint16_t</span> blockQuantity <span class="op">=</span> promptForWord<span class="op">(</span><span class="st">&quot;Block Quantity?&quot;</span><span class="op">);</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>	<span class="co">// quick check to make sure they didn&#39;t want zero blocks</span></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>	<span class="cf">while</span> <span class="op">(!</span>blockQuantity<span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>		blockQuantity <span class="op">=</span> promptForWord<span class="op">(</span><span class="st">&quot;Quantity &gt; 0!&quot;</span><span class="op">);</span></span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>	<span class="co">// turns the user&#39;s block size from a letter choice to a number</span></span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>	<span class="cf">switch</span> <span class="op">(</span>blockSize<span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="bn">0x0B</span><span class="op">:</span> <span class="co">// word</span></span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>			blockSize <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="bn">0x0C</span><span class="op">:</span> <span class="co">// double word</span></span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>			blockSize <span class="op">=</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="bn">0x0D</span><span class="op">:</span> <span class="co">// quad word!</span></span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>			blockSize <span class="op">=</span> <span class="dv">8</span><span class="op">;</span></span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>		<span class="cf">default</span><span class="op">:</span> <span class="co">// byte</span></span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>			blockSize <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>	clearLCD<span class="op">();</span></span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a>	<span class="co">// begin our pagination</span></span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> pageChoice <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint16_t</span> currentPage <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a>	<span class="cf">while</span> <span class="op">(</span>pageChoice <span class="op">!=</span> <span class="bn">0x0E</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a>		<span class="dt">bool</span> pagesBefore <span class="op">=</span> currentPage <span class="op">&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a>		<span class="co">// check both for if the user requested this many pages, and also make sure we don&#39;t overflow</span></span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a>		<span class="dt">bool</span> pagesAfter <span class="op">=</span> <span class="op">(</span>currentPage <span class="op">&lt;</span> blockQuantity<span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">((</span>startAddress <span class="op">+</span> blockSize<span class="op">)</span> <span class="op">&gt;</span> startAddress<span class="op">);</span></span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a>		pageChoice <span class="op">=</span> dumpPage<span class="op">(</span>startAddress<span class="op">,</span> blockSize<span class="op">,</span> pagesBefore<span class="op">,</span> pagesAfter<span class="op">);</span></span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a>		<span class="cf">if</span> <span class="op">(</span>pageChoice <span class="op">==</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> currentPage <span class="op">&lt;</span> blockQuantity<span class="op">)</span> <span class="op">{</span> <span class="co">// next page</span></span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a>			currentPage<span class="op">++;</span></span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a>			startAddress <span class="op">+=</span> blockSize<span class="op">;</span></span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span></span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a>		<span class="cf">if</span> <span class="op">(</span>pageChoice <span class="op">==</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> currentPage <span class="op">&gt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> <span class="co">// prev page</span></span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a>			currentPage<span class="op">--;</span></span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a>			startAddress <span class="op">-=</span> blockSize<span class="op">;</span></span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span></span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb7" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">// associated header file</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Edit.h&quot;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">// including standard headers and portable datatypes</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;8051.h&quot;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;LCD.h&quot;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Keypad.h&quot;</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Utils.h&quot;</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Memory.h&quot;</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Constants.h&quot;</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> editPage<span class="op">(</span><span class="dt">uint16_t</span> address<span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>	clearLCD<span class="op">();</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>	<span class="co">// current memory address</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;Editing 0x&quot;</span><span class="op">);</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>	printHexWordToASCIIArray<span class="op">(</span>address<span class="op">);</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;...&quot;</span><span class="op">);</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">35</span><span class="op">);</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;Type to replace value&quot;</span><span class="op">);</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>	<span class="co">// data at memory location</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">140</span><span class="op">,</span> <span class="dv">120</span><span class="op">);</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>	printHexByteToASCIIArray<span class="op">(</span>readFromExternalAddress<span class="op">(</span>address<span class="op">));</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>	<span class="co">// let the user write a value</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">140</span><span class="op">,</span> <span class="dv">120</span><span class="op">);</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>	<span class="co">// first nibble</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> firstCharacter <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span>asciiLookup<span class="op">[</span>firstCharacter<span class="op">]);</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>	<span class="co">// second nibble</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> secondCharacter <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span>asciiLookup<span class="op">[</span>secondCharacter<span class="op">]);</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>	<span class="co">// combine and return</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> <span class="op">(</span>firstCharacter <span class="op">&lt;&lt;</span> <span class="dv">4</span><span class="op">)</span> <span class="op">|</span> secondCharacter<span class="op">;</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> edit<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint16_t</span> startAddress <span class="op">=</span> promptForWord<span class="op">(</span><span class="st">&quot;Edit Address?&quot;</span><span class="op">);</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>	<span class="co">// lets show the memory at that address</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> userChoice <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>	<span class="cf">while</span> <span class="op">(</span>userChoice <span class="op">!=</span> <span class="bn">0xE</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>		userChoice <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>		<span class="dt">uint8_t</span> userByte <span class="op">=</span> editPage<span class="op">(</span>startAddress<span class="op">);</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>		writeToExternalAddress<span class="op">(</span>startAddress<span class="op">,</span> userByte<span class="op">);</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>		setCursor<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">216</span><span class="op">);</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>		printString<span class="op">(</span><span class="st">&quot;&lt;E Exit           Next 0&gt;&quot;</span><span class="op">);</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>		<span class="cf">while</span> <span class="op">(</span>userChoice <span class="op">!=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> userChoice <span class="op">!=</span> <span class="bn">0xE</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>			userChoice <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>		<span class="co">// overflow check</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>		<span class="cf">if</span> <span class="op">(</span>startAddress <span class="op">+</span> <span class="dv">1</span> <span class="op">&lt;</span> startAddress<span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>			errorBackToMenu<span class="op">(</span><span class="st">&quot;End of memory!&quot;</span><span class="op">);</span></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span><span class="op">;</span></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>			startAddress<span class="op">++;</span></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span><span class="op">;</span></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb8" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">// associated header file</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Find.h&quot;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">// including standard headers and portable datatypes</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;8051.h&quot;</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;LCD.h&quot;</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Keypad.h&quot;</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Utils.h&quot;</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Memory.h&quot;</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Bool.h&quot;</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> findPage<span class="op">(</span><span class="dt">uint16_t</span> address<span class="op">,</span> <span class="dt">bool</span> pagesBefore<span class="op">,</span> <span class="dt">bool</span> pagesAfter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>	<span class="co">// back indicator</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">7</span><span class="op">,</span> <span class="dv">216</span><span class="op">);</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> <span class="op">(</span>pagesBefore<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>		printString<span class="op">(</span><span class="st">&quot;&lt;1&quot;</span><span class="op">);</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>		printString<span class="op">(</span><span class="st">&quot;| &quot;</span><span class="op">);</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>	<span class="co">// current memory address</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">120</span><span class="op">,</span> <span class="dv">216</span><span class="op">);</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;0x&quot;</span><span class="op">);</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>	printHexWordToASCIIArray<span class="op">(</span>address<span class="op">);</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>	<span class="co">// next indicator</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">295</span><span class="op">,</span> <span class="dv">216</span><span class="op">);</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> <span class="op">(</span>pagesAfter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>		printString<span class="op">(</span><span class="st">&quot;0&gt;&quot;</span><span class="op">);</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>		printString<span class="op">(</span><span class="st">&quot; |&quot;</span><span class="op">);</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>	<span class="cf">while</span> <span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>		<span class="dt">uint8_t</span> pageChoice <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>		<span class="cf">if</span> <span class="op">((</span>pageChoice <span class="op">==</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> pagesAfter<span class="op">)</span> <span class="op">||</span> <span class="op">(</span>pageChoice <span class="op">==</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> pagesBefore<span class="op">)</span> <span class="op">||</span> pageChoice <span class="op">==</span> <span class="bn">0x0E</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> pageChoice<span class="op">;</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> findArgs<span class="op">(</span><span class="dt">uint16_t</span> startAddress<span class="op">,</span> <span class="dt">uint16_t</span> blockQuantity<span class="op">,</span> <span class="dt">uint8_t</span> searchValue<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>	clearLCD<span class="op">();</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;Finding 0x&quot;</span><span class="op">);</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>	printHexByteToASCIIArray<span class="op">(</span>searchValue<span class="op">);</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;... E to exit&quot;</span><span class="op">);</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>	<span class="co">// start searching</span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>	<span class="dt">bool</span> found <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint16_t</span> foundAddress <span class="op">=</span> searchForwardForExternalValue<span class="op">(</span>startAddress<span class="op">,</span> searchValue<span class="op">,</span> <span class="op">&amp;</span>found<span class="op">);</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> <span class="op">(</span>foundAddress <span class="op">&lt;</span> startAddress <span class="op">||</span> foundAddress <span class="op">&gt;</span> startAddress <span class="op">+</span> blockQuantity<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>		<span class="co">// we couldn&#39;t find anything</span></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>		errorBackToMenu<span class="op">(</span><span class="st">&quot;Byte not found!&quot;</span><span class="op">);</span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>		<span class="cf">return</span><span class="op">;</span></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>		<span class="dt">uint8_t</span> userChoice <span class="op">=</span> <span class="bn">0xF</span><span class="op">;</span></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>		<span class="cf">while</span> <span class="op">(</span>userChoice <span class="op">!=</span> <span class="bn">0xE</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>			<span class="co">// see if we have before</span></span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>			<span class="dt">bool</span> pagesBefore <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>			<span class="dt">uint16_t</span> beforeAddress <span class="op">=</span> searchBackwardForExternalValue<span class="op">(</span>foundAddress <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> searchValue<span class="op">,</span> <span class="op">&amp;</span>pagesBefore<span class="op">);</span></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>			<span class="co">// make sure the address we found is actually within our range</span></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>			<span class="cf">if</span> <span class="op">(</span>pagesBefore<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>				pagesBefore <span class="op">=</span> beforeAddress <span class="op">&gt;=</span> startAddress<span class="op">;</span></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>			<span class="op">}</span></span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>			<span class="co">// see if we have after</span></span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>			<span class="dt">bool</span> pagesAfter <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>			<span class="dt">uint16_t</span> afterAddress <span class="op">=</span> searchForwardForExternalValue<span class="op">(</span>foundAddress <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> searchValue<span class="op">,</span> <span class="op">&amp;</span>pagesAfter<span class="op">);</span></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>			<span class="co">// make sure the address we found is actually within our range</span></span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>			<span class="cf">if</span> <span class="op">(</span>pagesAfter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>				pagesAfter <span class="op">=</span> afterAddress <span class="op">&lt;=</span> startAddress <span class="op">+</span> blockQuantity<span class="op">;</span></span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>			<span class="op">}</span></span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>			userChoice <span class="op">=</span> findPage<span class="op">(</span>foundAddress<span class="op">,</span> pagesBefore<span class="op">,</span> pagesAfter<span class="op">);</span></span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>			<span class="cf">if</span> <span class="op">(</span>userChoice <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>				foundAddress <span class="op">=</span> afterAddress<span class="op">;</span></span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>			<span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>userChoice <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>				foundAddress <span class="op">=</span> beforeAddress<span class="op">;</span></span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>			<span class="op">}</span></span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span></span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>		<span class="cf">return</span><span class="op">;</span></span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> find<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint16_t</span> startAddress <span class="op">=</span> promptForWord<span class="op">(</span><span class="st">&quot;Find Address?&quot;</span><span class="op">);</span></span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint16_t</span> blockQuantity <span class="op">=</span> promptForWord<span class="op">(</span><span class="st">&quot;Byte Quantity?&quot;</span><span class="op">);</span></span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> searchValue <span class="op">=</span> promptForByte<span class="op">(</span><span class="st">&quot;Search For?&quot;</span><span class="op">);</span></span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a>	<span class="co">// quick check to make sure they didn&#39;t want zero blocks</span></span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>	<span class="cf">while</span> <span class="op">(!</span>blockQuantity<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a>		blockQuantity <span class="op">=</span> promptForWord<span class="op">(</span><span class="st">&quot;Quantity &gt; 0!&quot;</span><span class="op">);</span></span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a>	findArgs<span class="op">(</span>startAddress<span class="op">,</span> blockQuantity<span class="op">,</span> searchValue<span class="op">);</span></span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb9" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">// associated header file</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Keypad.h&quot;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">// including standard headers and portable datatypes</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;8051.h&quot;</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;LCD.h&quot;</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Constants.h&quot;</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Segment.h&quot;</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="pp">#define KEYPAD_PORT P1</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> __idata serialData<span class="op">;</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">// flashes the rows of the matrix keypad and returns a byte representing the current row pressed (if any)</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> checkRows<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>	KEYPAD_PORT <span class="op">=</span> <span class="bn">0xF0</span><span class="op">;</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> KEYPAD_PORT<span class="op">;</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co">// flashes the columns of the matrix keypad and returns a byte representing the current column pressed (if any)</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> checkColumns<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>	KEYPAD_PORT <span class="op">=</span> <span class="bn">0x0F</span><span class="op">;</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> KEYPAD_PORT<span class="op">;</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co">// non-blocking function to read the current button pressed</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co">// if none is pressed, return 0</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> readKeypad<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> rowValue <span class="op">=</span> checkRows<span class="op">();</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> <span class="op">(</span>rowValue <span class="op">!=</span> <span class="bn">0xF0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>		<span class="dt">uint8_t</span> columnValue <span class="op">=</span> checkColumns<span class="op">();</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>		<span class="cf">if</span> <span class="op">(</span>columnValue <span class="op">!=</span> <span class="bn">0x0F</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> rowValue <span class="op">|</span> columnValue<span class="op">;</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>	<span class="co">// check our serial</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> <span class="op">(</span>serialData <span class="op">!=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>		<span class="dt">uint8_t</span> incomingSerial <span class="op">=</span> serialData<span class="op">;</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>		serialData <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>		<span class="cf">return</span> incomingSerial<span class="op">;</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a><span class="co">// converts the incoming keypad index into the numerical value of the button pressed</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> decodeKeypadToHex<span class="op">(</span><span class="dt">uint8_t</span> keypadIndex<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>	<span class="cf">switch</span><span class="op">(</span>keypadIndex<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="bn">0xD7</span><span class="op">:</span> <span class="co">// 3</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="bn">0xEE</span><span class="op">:</span> <span class="co">// D</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> <span class="dv">13</span><span class="op">;</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="bn">0xDE</span><span class="op">:</span> <span class="co">// E</span></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> <span class="dv">14</span><span class="op">;</span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="bn">0xBE</span><span class="op">:</span> <span class="co">// 0</span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="bn">0xED</span><span class="op">:</span> <span class="co">// C</span></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> <span class="dv">12</span><span class="op">;</span></span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="bn">0xDD</span><span class="op">:</span> <span class="co">// 9</span></span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> <span class="dv">9</span><span class="op">;</span></span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="bn">0xBD</span><span class="op">:</span> <span class="co">// 8</span></span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> <span class="dv">8</span><span class="op">;</span></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="bn">0xEB</span><span class="op">:</span> <span class="co">// B</span></span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> <span class="dv">11</span><span class="op">;</span></span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="bn">0xDB</span><span class="op">:</span> <span class="co">// 6</span></span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> <span class="dv">6</span><span class="op">;</span></span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="bn">0xBB</span><span class="op">:</span> <span class="co">// 5</span></span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="bn">0x7E</span><span class="op">:</span> <span class="co">// F</span></span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> <span class="dv">15</span><span class="op">;</span></span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="bn">0x7D</span><span class="op">:</span> <span class="co">// 7</span></span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> <span class="dv">7</span><span class="op">;</span></span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="bn">0x7B</span><span class="op">:</span> <span class="co">// 4</span></span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="bn">0x77</span><span class="op">:</span> <span class="co">// 1</span></span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="bn">0xB7</span><span class="op">:</span> <span class="co">// 2</span></span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="bn">0xE7</span><span class="op">:</span> <span class="co">// A</span></span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a>		<span class="cf">default</span><span class="op">:</span></span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> <span class="dv">16</span><span class="op">;</span></span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a><span class="co">// blocking function, returns the numerical value of the key the user pressed</span></span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> waitForKeypad<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> keypadIndex <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a>	<span class="cf">while</span> <span class="op">(</span>keypadIndex <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true" tabindex="-1"></a>		keypadIndex <span class="op">=</span> readKeypad<span class="op">();</span></span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> keypadValue <span class="op">=</span> decodeKeypadToHex<span class="op">(</span>keypadIndex<span class="op">);</span></span>
<span id="cb9-109"><a href="#cb9-109" aria-hidden="true" tabindex="-1"></a>	hexToSegment<span class="op">(</span>keypadValue<span class="op">);</span></span>
<span id="cb9-110"><a href="#cb9-110" aria-hidden="true" tabindex="-1"></a>	delay<span class="op">(</span><span class="dv">500</span><span class="op">);</span></span>
<span id="cb9-111"><a href="#cb9-111" aria-hidden="true" tabindex="-1"></a>	<span class="cf">while</span> <span class="op">(</span>keypadIndex <span class="op">!=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-112"><a href="#cb9-112" aria-hidden="true" tabindex="-1"></a>		keypadIndex <span class="op">=</span> readKeypad<span class="op">();</span></span>
<span id="cb9-113"><a href="#cb9-113" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb9-114"><a href="#cb9-114" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> keypadValue<span class="op">;</span></span>
<span id="cb9-115"><a href="#cb9-115" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-116"><a href="#cb9-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-117"><a href="#cb9-117" aria-hidden="true" tabindex="-1"></a><span class="co">// blocking function to wait for a specific key to be pressed</span></span>
<span id="cb9-118"><a href="#cb9-118" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> waitForKey<span class="op">(</span><span class="dt">uint8_t</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-119"><a href="#cb9-119" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> keypadValue <span class="op">=</span> <span class="dv">16</span><span class="op">;</span></span>
<span id="cb9-120"><a href="#cb9-120" aria-hidden="true" tabindex="-1"></a>	<span class="cf">while</span> <span class="op">(</span>keypadValue <span class="op">!=</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-121"><a href="#cb9-121" aria-hidden="true" tabindex="-1"></a>		keypadValue <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb9-122"><a href="#cb9-122" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb9-123"><a href="#cb9-123" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-124"><a href="#cb9-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-125"><a href="#cb9-125" aria-hidden="true" tabindex="-1"></a><span class="co">// prompts for a byte using the passed string and returning a single byte</span></span>
<span id="cb9-126"><a href="#cb9-126" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> promptForByte<span class="op">(</span><span class="dt">char</span><span class="op">*</span> prompt<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-127"><a href="#cb9-127" aria-hidden="true" tabindex="-1"></a>	<span class="co">// print instructions</span></span>
<span id="cb9-128"><a href="#cb9-128" aria-hidden="true" tabindex="-1"></a>	clearLCD<span class="op">();</span></span>
<span id="cb9-129"><a href="#cb9-129" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb9-130"><a href="#cb9-130" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span>prompt<span class="op">);</span></span>
<span id="cb9-131"><a href="#cb9-131" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">35</span><span class="op">);</span></span>
<span id="cb9-132"><a href="#cb9-132" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;Byte: 0x&quot;</span><span class="op">);</span></span>
<span id="cb9-133"><a href="#cb9-133" aria-hidden="true" tabindex="-1"></a>	<span class="dt">int</span> oldCursorX <span class="op">=</span> getCursorX<span class="op">();</span></span>
<span id="cb9-134"><a href="#cb9-134" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;__&quot;</span><span class="op">);</span></span>
<span id="cb9-135"><a href="#cb9-135" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span>oldCursorX<span class="op">,</span> <span class="dv">35</span><span class="op">);</span></span>
<span id="cb9-136"><a href="#cb9-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-137"><a href="#cb9-137" aria-hidden="true" tabindex="-1"></a>	<span class="co">// first character</span></span>
<span id="cb9-138"><a href="#cb9-138" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> firstCharacter <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb9-139"><a href="#cb9-139" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span>asciiLookup<span class="op">[</span>firstCharacter<span class="op">]);</span></span>
<span id="cb9-140"><a href="#cb9-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-141"><a href="#cb9-141" aria-hidden="true" tabindex="-1"></a>	<span class="co">// second character</span></span>
<span id="cb9-142"><a href="#cb9-142" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> secondCharacter <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb9-143"><a href="#cb9-143" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span>asciiLookup<span class="op">[</span>secondCharacter<span class="op">]);</span></span>
<span id="cb9-144"><a href="#cb9-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-145"><a href="#cb9-145" aria-hidden="true" tabindex="-1"></a>	<span class="co">// combine and return</span></span>
<span id="cb9-146"><a href="#cb9-146" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> <span class="op">(</span>firstCharacter <span class="op">&lt;&lt;</span> <span class="dv">4</span><span class="op">)</span> <span class="op">|</span> secondCharacter<span class="op">;</span></span>
<span id="cb9-147"><a href="#cb9-147" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-148"><a href="#cb9-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-149"><a href="#cb9-149" aria-hidden="true" tabindex="-1"></a><span class="dt">uint16_t</span> promptForWord<span class="op">(</span><span class="dt">char</span><span class="op">*</span> prompt<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-150"><a href="#cb9-150" aria-hidden="true" tabindex="-1"></a>	<span class="co">// print instructions</span></span>
<span id="cb9-151"><a href="#cb9-151" aria-hidden="true" tabindex="-1"></a>	clearLCD<span class="op">();</span></span>
<span id="cb9-152"><a href="#cb9-152" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb9-153"><a href="#cb9-153" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span>prompt<span class="op">);</span></span>
<span id="cb9-154"><a href="#cb9-154" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">35</span><span class="op">);</span></span>
<span id="cb9-155"><a href="#cb9-155" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;Word: 0x&quot;</span><span class="op">);</span></span>
<span id="cb9-156"><a href="#cb9-156" aria-hidden="true" tabindex="-1"></a>	<span class="dt">int</span> oldCursorX <span class="op">=</span> getCursorX<span class="op">();</span></span>
<span id="cb9-157"><a href="#cb9-157" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;____&quot;</span><span class="op">);</span></span>
<span id="cb9-158"><a href="#cb9-158" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span>oldCursorX<span class="op">,</span> <span class="dv">35</span><span class="op">);</span></span>
<span id="cb9-159"><a href="#cb9-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-160"><a href="#cb9-160" aria-hidden="true" tabindex="-1"></a>	<span class="co">// first character</span></span>
<span id="cb9-161"><a href="#cb9-161" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> firstCharacter <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb9-162"><a href="#cb9-162" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span>asciiLookup<span class="op">[</span>firstCharacter<span class="op">]);</span></span>
<span id="cb9-163"><a href="#cb9-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-164"><a href="#cb9-164" aria-hidden="true" tabindex="-1"></a>	<span class="co">// second character</span></span>
<span id="cb9-165"><a href="#cb9-165" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> secondCharacter <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb9-166"><a href="#cb9-166" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span>asciiLookup<span class="op">[</span>secondCharacter<span class="op">]);</span></span>
<span id="cb9-167"><a href="#cb9-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-168"><a href="#cb9-168" aria-hidden="true" tabindex="-1"></a>	<span class="co">// third character</span></span>
<span id="cb9-169"><a href="#cb9-169" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> thirdCharacter <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb9-170"><a href="#cb9-170" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span>asciiLookup<span class="op">[</span>thirdCharacter<span class="op">]);</span></span>
<span id="cb9-171"><a href="#cb9-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-172"><a href="#cb9-172" aria-hidden="true" tabindex="-1"></a>	<span class="co">// fourth character</span></span>
<span id="cb9-173"><a href="#cb9-173" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> fourthCharacter <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb9-174"><a href="#cb9-174" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span>asciiLookup<span class="op">[</span>fourthCharacter<span class="op">]);</span></span>
<span id="cb9-175"><a href="#cb9-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-176"><a href="#cb9-176" aria-hidden="true" tabindex="-1"></a>	<span class="co">// combine and return</span></span>
<span id="cb9-177"><a href="#cb9-177" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> <span class="op">(</span>firstCharacter <span class="op">&lt;&lt;</span> <span class="dv">12</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span>secondCharacter <span class="op">&lt;&lt;</span> <span class="dv">8</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span>thirdCharacter <span class="op">&lt;&lt;</span> <span class="dv">4</span><span class="op">)</span> <span class="op">|</span> fourthCharacter<span class="op">;</span></span>
<span id="cb9-178"><a href="#cb9-178" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-179"><a href="#cb9-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-180"><a href="#cb9-180" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> setSerialData<span class="op">(</span><span class="dt">uint8_t</span> data<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-181"><a href="#cb9-181" aria-hidden="true" tabindex="-1"></a>	serialData <span class="op">=</span> data<span class="op">;</span></span>
<span id="cb9-182"><a href="#cb9-182" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-183"><a href="#cb9-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-184"><a href="#cb9-184" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> getSerialData<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-185"><a href="#cb9-185" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> serialData<span class="op">;</span></span>
<span id="cb9-186"><a href="#cb9-186" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb10" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">	author: Matthew Boeding</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">	version: v1.0</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">	README</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">/// TFT-LCD (ILI9341) Driver code for the 8051. Can be repurposed for other drivers controllers :)</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">/// I optimized the code quite a bit for speed, utilizing internal pointers</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">/// Please do not post any of the code from this course to GITHUB.</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;LCD.h&quot;</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;bmp_image.h&quot;</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;font.h&quot;</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Keypad.h&quot;</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>__xdata <span class="dt">uint8_t</span><span class="op">*</span> lcd_address <span class="op">=</span> <span class="op">(</span><span class="dt">uint8_t</span> __xdata<span class="op">*)</span> LCD_ADDRESS<span class="op">;</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">/* cursor_y and cursor_x globals*/</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="dt">uint16_t</span> __idata<span class="op">*</span> cursor_x <span class="op">=</span> <span class="op">(</span><span class="dt">uint16_t</span> __idata<span class="op">*)(</span><span class="bn">0xC2</span><span class="op">);</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="dt">uint16_t</span> __idata<span class="op">*</span> cursor_y <span class="op">=</span> <span class="op">(</span><span class="dt">uint16_t</span> __idata<span class="op">*)(</span><span class="bn">0xC4</span><span class="op">);</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co">/* textsize and rotation*/</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> __idata<span class="op">*</span> textsize <span class="op">=</span> <span class="op">(</span><span class="dt">uint8_t</span> __idata<span class="op">*)(</span><span class="bn">0xC6</span><span class="op">);</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> __idata<span class="op">*</span> rotation <span class="op">=</span> <span class="op">(</span><span class="dt">uint8_t</span> __idata<span class="op">*)(</span><span class="bn">0xC7</span><span class="op">);</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co">/* text color and background */</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="dt">uint16_t</span> __idata<span class="op">*</span> textcolor <span class="op">=</span> <span class="op">(</span><span class="dt">uint16_t</span> __idata<span class="op">*)(</span><span class="bn">0xC8</span><span class="op">);</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="dt">uint16_t</span> __idata<span class="op">*</span> textbgcolor <span class="op">=</span> <span class="op">(</span><span class="dt">uint16_t</span> __idata<span class="op">*)(</span><span class="bn">0xCA</span><span class="op">);</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co">/* lcd width and height */</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="dt">uint16_t</span> __idata<span class="op">*</span> _width <span class="op">=</span> <span class="op">(</span><span class="dt">uint16_t</span> __idata<span class="op">*)(</span><span class="bn">0xCC</span><span class="op">);</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="dt">uint16_t</span> __idata<span class="op">*</span> _height <span class="op">=</span> <span class="op">(</span><span class="dt">uint16_t</span> __idata<span class="op">*)(</span><span class="bn">0xCE</span><span class="op">);</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>__code <span class="dt">uint8_t</span> intro1<span class="op">[</span><span class="dv">9</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="st">&quot;Welcome</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> delay <span class="op">(</span><span class="dt">int16_t</span> d<span class="op">)</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>	<span class="dt">int16_t</span> i<span class="op">,</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="co">/* declare for backwards compatibility with older C standards */</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>	<span class="cf">for</span> <span class="op">(</span>i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>d<span class="op">;</span>i<span class="op">++)</span> <span class="co">/* this is For(); loop delay used to define delay value in Embedded C*/</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>	<span class="op">{</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>		<span class="cf">for</span> <span class="op">(</span>j<span class="op">=</span><span class="dv">0</span><span class="op">;</span>j<span class="op">&lt;</span><span class="dv">80</span><span class="op">;</span>j<span class="op">++)</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>		<span class="op">{</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> lcdWrite8Reg<span class="op">(</span><span class="dt">uint8_t</span> d<span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>	CD <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>	IOM <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>	<span class="op">*</span>lcd_address <span class="op">=</span> d<span class="op">;</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>	IOM <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> lcdWrite8Data<span class="op">(</span><span class="dt">uint8_t</span> d<span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>	CD <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>	IOM <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>	<span class="op">*</span>lcd_address <span class="op">=</span> d<span class="op">;</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>	IOM <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> lcdWrite8DataBlocking<span class="op">(</span><span class="dt">uint8_t</span> d<span class="op">)</span></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>	<span class="op">*</span>lcd_address <span class="op">=</span> d<span class="op">;</span></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> lcdWriteRegData8<span class="op">(</span><span class="dt">uint8_t</span> a<span class="op">,</span> <span class="dt">uint8_t</span> d<span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>	CD <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>	IOM <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>	<span class="op">*</span>lcd_address <span class="op">=</span> a<span class="op">;</span></span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>	IOM <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>	CD <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>	IOM <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a>	<span class="op">*</span>lcd_address <span class="op">=</span> d<span class="op">;</span></span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a>	IOM <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a><span class="dt">uint16_t</span> getCursorX<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> <span class="op">*</span>cursor_x<span class="op">;</span></span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a><span class="dt">uint16_t</span> getCursorY<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> <span class="op">*</span>cursor_y<span class="op">;</span></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> getTextSize<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> <span class="op">*</span>textsize<span class="op">;</span></span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> setCursorx<span class="op">(</span><span class="dt">uint16_t</span> x<span class="op">)</span></span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a>	<span class="op">*</span>cursor_x <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> setCursory<span class="op">(</span><span class="dt">uint16_t</span> y<span class="op">)</span></span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a>	<span class="op">*</span>cursor_y <span class="op">=</span> y<span class="op">;</span></span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> lcdWriteRegData16<span class="op">(</span><span class="dt">uint16_t</span> a<span class="op">,</span> <span class="dt">uint16_t</span> d<span class="op">){</span></span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> hi<span class="op">,</span> lo<span class="op">;</span></span>
<span id="cb10-102"><a href="#cb10-102" aria-hidden="true" tabindex="-1"></a> 	hi <span class="op">=</span> <span class="op">(</span>a<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">8</span><span class="op">;</span></span>
<span id="cb10-103"><a href="#cb10-103" aria-hidden="true" tabindex="-1"></a> 	lo <span class="op">=</span> <span class="op">(</span>a<span class="op">);</span></span>
<span id="cb10-104"><a href="#cb10-104" aria-hidden="true" tabindex="-1"></a> 	lcdWrite8Reg<span class="op">(</span>hi<span class="op">);</span></span>
<span id="cb10-105"><a href="#cb10-105" aria-hidden="true" tabindex="-1"></a> 	lcdWrite8Reg<span class="op">(</span>lo<span class="op">);</span></span>
<span id="cb10-106"><a href="#cb10-106" aria-hidden="true" tabindex="-1"></a>  	hi <span class="op">=</span> <span class="op">(</span>d<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">8</span><span class="op">;</span></span>
<span id="cb10-107"><a href="#cb10-107" aria-hidden="true" tabindex="-1"></a>  	lo <span class="op">=</span> <span class="op">(</span>d<span class="op">);</span></span>
<span id="cb10-108"><a href="#cb10-108" aria-hidden="true" tabindex="-1"></a>  	lcdWrite8Data<span class="op">(</span>hi<span class="op">);</span></span>
<span id="cb10-109"><a href="#cb10-109" aria-hidden="true" tabindex="-1"></a>  	lcdWrite8Data<span class="op">(</span>lo<span class="op">);</span></span>
<span id="cb10-110"><a href="#cb10-110" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-111"><a href="#cb10-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-112"><a href="#cb10-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-113"><a href="#cb10-113" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> setCursor<span class="op">(</span><span class="dt">uint16_t</span> x<span class="op">,</span> <span class="dt">uint16_t</span> y<span class="op">){</span></span>
<span id="cb10-114"><a href="#cb10-114" aria-hidden="true" tabindex="-1"></a>	<span class="op">*</span>cursor_x <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb10-115"><a href="#cb10-115" aria-hidden="true" tabindex="-1"></a>	<span class="op">*</span>cursor_y <span class="op">=</span> y<span class="op">;</span></span>
<span id="cb10-116"><a href="#cb10-116" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-117"><a href="#cb10-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-118"><a href="#cb10-118" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> setTextColor<span class="op">(</span><span class="dt">uint16_t</span> x<span class="op">,</span> <span class="dt">uint16_t</span> y<span class="op">){</span></span>
<span id="cb10-119"><a href="#cb10-119" aria-hidden="true" tabindex="-1"></a>	<span class="op">*</span>textcolor <span class="op">=</span>  x<span class="op">;</span></span>
<span id="cb10-120"><a href="#cb10-120" aria-hidden="true" tabindex="-1"></a>	<span class="op">*</span>textbgcolor <span class="op">=</span> y<span class="op">;</span></span>
<span id="cb10-121"><a href="#cb10-121" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-122"><a href="#cb10-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-123"><a href="#cb10-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-124"><a href="#cb10-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-125"><a href="#cb10-125" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> setTextSize<span class="op">(</span><span class="dt">uint8_t</span> s<span class="op">){</span></span>
<span id="cb10-126"><a href="#cb10-126" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> <span class="op">(</span>s <span class="op">&gt;</span> <span class="dv">8</span><span class="op">)</span> <span class="cf">return</span><span class="op">;</span></span>
<span id="cb10-127"><a href="#cb10-127" aria-hidden="true" tabindex="-1"></a>	<span class="op">*</span>textsize <span class="op">=</span> <span class="op">(</span>s<span class="op">&gt;</span><span class="dv">0</span><span class="op">)</span> <span class="op">?</span> s <span class="op">:</span> <span class="dv">1</span> <span class="op">;</span></span>
<span id="cb10-128"><a href="#cb10-128" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-129"><a href="#cb10-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-130"><a href="#cb10-130" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> setRotation<span class="op">(</span><span class="dt">uint8_t</span> flag<span class="op">){</span></span>
<span id="cb10-131"><a href="#cb10-131" aria-hidden="true" tabindex="-1"></a>	<span class="op">*</span>rotation <span class="op">=</span> flag<span class="op">;</span></span>
<span id="cb10-132"><a href="#cb10-132" aria-hidden="true" tabindex="-1"></a>	<span class="cf">switch</span><span class="op">(</span>flag<span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-133"><a href="#cb10-133" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="dv">0</span><span class="op">:</span></span>
<span id="cb10-134"><a href="#cb10-134" aria-hidden="true" tabindex="-1"></a>			flag <span class="op">=</span> <span class="op">(</span>ILI9341_MADCTL_MX <span class="op">|</span> ILI9341_MADCTL_BGR<span class="op">);</span></span>
<span id="cb10-135"><a href="#cb10-135" aria-hidden="true" tabindex="-1"></a>			<span class="op">*</span>_width <span class="op">=</span> TFTWIDTH<span class="op">;</span></span>
<span id="cb10-136"><a href="#cb10-136" aria-hidden="true" tabindex="-1"></a>			<span class="op">*</span>_height <span class="op">=</span> TFTHEIGHT<span class="op">;</span></span>
<span id="cb10-137"><a href="#cb10-137" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb10-138"><a href="#cb10-138" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="dv">1</span><span class="op">:</span></span>
<span id="cb10-139"><a href="#cb10-139" aria-hidden="true" tabindex="-1"></a>			flag <span class="op">=</span> <span class="op">(</span>ILI9341_MADCTL_MV <span class="op">|</span> ILI9341_MADCTL_BGR<span class="op">);</span></span>
<span id="cb10-140"><a href="#cb10-140" aria-hidden="true" tabindex="-1"></a>			<span class="op">*</span>_width <span class="op">=</span> TFTHEIGHT<span class="op">;</span></span>
<span id="cb10-141"><a href="#cb10-141" aria-hidden="true" tabindex="-1"></a>			<span class="op">*</span>_height <span class="op">=</span> TFTWIDTH<span class="op">;</span></span>
<span id="cb10-142"><a href="#cb10-142" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb10-143"><a href="#cb10-143" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="dv">2</span><span class="op">:</span></span>
<span id="cb10-144"><a href="#cb10-144" aria-hidden="true" tabindex="-1"></a>			flag <span class="op">=</span> <span class="op">(</span>ILI9341_MADCTL_MY <span class="op">|</span> ILI9341_MADCTL_BGR<span class="op">);</span></span>
<span id="cb10-145"><a href="#cb10-145" aria-hidden="true" tabindex="-1"></a>			<span class="op">*</span>_width <span class="op">=</span> TFTWIDTH<span class="op">;</span></span>
<span id="cb10-146"><a href="#cb10-146" aria-hidden="true" tabindex="-1"></a>			<span class="op">*</span>_height <span class="op">=</span> TFTHEIGHT<span class="op">;</span></span>
<span id="cb10-147"><a href="#cb10-147" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb10-148"><a href="#cb10-148" aria-hidden="true" tabindex="-1"></a>	  	<span class="cf">case</span> <span class="dv">3</span><span class="op">:</span></span>
<span id="cb10-149"><a href="#cb10-149" aria-hidden="true" tabindex="-1"></a>			flag <span class="op">=</span> <span class="op">(</span>ILI9341_MADCTL_MX <span class="op">|</span> ILI9341_MADCTL_MY <span class="op">|</span> ILI9341_MADCTL_MV <span class="op">|</span> ILI9341_MADCTL_BGR<span class="op">);</span></span>
<span id="cb10-150"><a href="#cb10-150" aria-hidden="true" tabindex="-1"></a>			<span class="op">*</span>_width <span class="op">=</span> TFTHEIGHT<span class="op">;</span></span>
<span id="cb10-151"><a href="#cb10-151" aria-hidden="true" tabindex="-1"></a>			<span class="op">*</span>_height <span class="op">=</span> TFTWIDTH<span class="op">;</span></span>
<span id="cb10-152"><a href="#cb10-152" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb10-153"><a href="#cb10-153" aria-hidden="true" tabindex="-1"></a>		<span class="cf">default</span><span class="op">:</span></span>
<span id="cb10-154"><a href="#cb10-154" aria-hidden="true" tabindex="-1"></a>			flag <span class="op">=</span> <span class="op">(</span>ILI9341_MADCTL_MX <span class="op">|</span> ILI9341_MADCTL_BGR<span class="op">);</span></span>
<span id="cb10-155"><a href="#cb10-155" aria-hidden="true" tabindex="-1"></a>			<span class="op">*</span>_width <span class="op">=</span> TFTWIDTH<span class="op">;</span></span>
<span id="cb10-156"><a href="#cb10-156" aria-hidden="true" tabindex="-1"></a>			<span class="op">*</span>_height <span class="op">=</span> TFTHEIGHT<span class="op">;</span></span>
<span id="cb10-157"><a href="#cb10-157" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb10-158"><a href="#cb10-158" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb10-159"><a href="#cb10-159" aria-hidden="true" tabindex="-1"></a>	lcdWriteRegData8<span class="op">(</span>ILI9341_MEMCONTROL<span class="op">,</span> flag<span class="op">);</span></span>
<span id="cb10-160"><a href="#cb10-160" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-161"><a href="#cb10-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-162"><a href="#cb10-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-163"><a href="#cb10-163" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> setAddress<span class="op">(</span><span class="dt">uint16_t</span> x1<span class="op">,</span><span class="dt">uint16_t</span> y1<span class="op">,</span><span class="dt">uint16_t</span> x2<span class="op">,</span><span class="dt">uint16_t</span> y2<span class="op">){</span></span>
<span id="cb10-164"><a href="#cb10-164" aria-hidden="true" tabindex="-1"></a>	lcdWrite8Reg<span class="op">(</span>ILI9341_COLADDRSET<span class="op">);</span></span>
<span id="cb10-165"><a href="#cb10-165" aria-hidden="true" tabindex="-1"></a>	lcdWrite8Data<span class="op">(</span>x1 <span class="op">&gt;&gt;</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb10-166"><a href="#cb10-166" aria-hidden="true" tabindex="-1"></a>	lcdWrite8Data<span class="op">(</span>x1<span class="op">);</span></span>
<span id="cb10-167"><a href="#cb10-167" aria-hidden="true" tabindex="-1"></a>	lcdWrite8Data<span class="op">(</span>x2 <span class="op">&gt;&gt;</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb10-168"><a href="#cb10-168" aria-hidden="true" tabindex="-1"></a>	lcdWrite8Data<span class="op">(</span>x2<span class="op">);</span></span>
<span id="cb10-169"><a href="#cb10-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-170"><a href="#cb10-170" aria-hidden="true" tabindex="-1"></a>	lcdWrite8Reg<span class="op">(</span>ILI9341_PAGEADDRSET<span class="op">);</span></span>
<span id="cb10-171"><a href="#cb10-171" aria-hidden="true" tabindex="-1"></a>	lcdWrite8Data<span class="op">(</span>y1 <span class="op">&gt;&gt;</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb10-172"><a href="#cb10-172" aria-hidden="true" tabindex="-1"></a>	lcdWrite8Data<span class="op">(</span>y1<span class="op">);</span></span>
<span id="cb10-173"><a href="#cb10-173" aria-hidden="true" tabindex="-1"></a>	lcdWrite8Data<span class="op">(</span>y2 <span class="op">&gt;&gt;</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb10-174"><a href="#cb10-174" aria-hidden="true" tabindex="-1"></a>	lcdWrite8Data<span class="op">(</span>y2<span class="op">);</span></span>
<span id="cb10-175"><a href="#cb10-175" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-176"><a href="#cb10-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-177"><a href="#cb10-177" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> initLCD<span class="op">(</span><span class="dt">void</span><span class="op">){</span></span>
<span id="cb10-178"><a href="#cb10-178" aria-hidden="true" tabindex="-1"></a>	<span class="op">*</span>_width <span class="op">=</span> TFTWIDTH<span class="op">;</span></span>
<span id="cb10-179"><a href="#cb10-179" aria-hidden="true" tabindex="-1"></a>	<span class="op">*</span>_height <span class="op">=</span> TFTHEIGHT<span class="op">;</span></span>
<span id="cb10-180"><a href="#cb10-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-181"><a href="#cb10-181" aria-hidden="true" tabindex="-1"></a>	lcdWrite8Reg<span class="op">(</span>ILI9341_MADCTL_RGB<span class="op">);</span></span>
<span id="cb10-182"><a href="#cb10-182" aria-hidden="true" tabindex="-1"></a>	lcdWrite8Data<span class="op">(</span><span class="bn">0x00</span><span class="op">);</span></span>
<span id="cb10-183"><a href="#cb10-183" aria-hidden="true" tabindex="-1"></a>	lcdWrite8Data<span class="op">(</span><span class="bn">0x00</span><span class="op">);</span></span>
<span id="cb10-184"><a href="#cb10-184" aria-hidden="true" tabindex="-1"></a>	lcdWrite8Data<span class="op">(</span><span class="bn">0x00</span><span class="op">);</span></span>
<span id="cb10-185"><a href="#cb10-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-186"><a href="#cb10-186" aria-hidden="true" tabindex="-1"></a>	delay<span class="op">(</span><span class="dv">200</span><span class="op">);</span></span>
<span id="cb10-187"><a href="#cb10-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-188"><a href="#cb10-188" aria-hidden="true" tabindex="-1"></a>	lcdWrite8Reg<span class="op">(</span>ILI9341_SOFTRESET<span class="op">);</span></span>
<span id="cb10-189"><a href="#cb10-189" aria-hidden="true" tabindex="-1"></a>    delay<span class="op">(</span><span class="dv">50</span><span class="op">);</span></span>
<span id="cb10-190"><a href="#cb10-190" aria-hidden="true" tabindex="-1"></a>    lcdWrite8Reg<span class="op">(</span>ILI9341_DISPLAYOFF<span class="op">);</span></span>
<span id="cb10-191"><a href="#cb10-191" aria-hidden="true" tabindex="-1"></a>    delay<span class="op">(</span><span class="dv">10</span><span class="op">);</span></span>
<span id="cb10-192"><a href="#cb10-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-193"><a href="#cb10-193" aria-hidden="true" tabindex="-1"></a>    lcdWriteRegData8<span class="op">(</span>ILI9341_POWERCONTROL1<span class="op">,</span> <span class="bn">0x23</span><span class="op">);</span></span>
<span id="cb10-194"><a href="#cb10-194" aria-hidden="true" tabindex="-1"></a>    lcdWriteRegData8<span class="op">(</span>ILI9341_POWERCONTROL2<span class="op">,</span> <span class="bn">0x11</span><span class="op">);</span></span>
<span id="cb10-195"><a href="#cb10-195" aria-hidden="true" tabindex="-1"></a>    lcdWrite8Reg<span class="op">(</span>ILI9341_VCOMCONTROL1<span class="op">);</span></span>
<span id="cb10-196"><a href="#cb10-196" aria-hidden="true" tabindex="-1"></a>	lcdWrite8Data<span class="op">(</span><span class="bn">0x3d</span><span class="op">);</span></span>
<span id="cb10-197"><a href="#cb10-197" aria-hidden="true" tabindex="-1"></a>	lcdWrite8Data<span class="op">(</span><span class="bn">0x30</span><span class="op">);</span></span>
<span id="cb10-198"><a href="#cb10-198" aria-hidden="true" tabindex="-1"></a>	lcdWriteRegData8<span class="op">(</span>ILI9341_VCOMCONTROL2<span class="op">,</span> <span class="bn">0xaa</span><span class="op">);</span></span>
<span id="cb10-199"><a href="#cb10-199" aria-hidden="true" tabindex="-1"></a>    lcdWriteRegData8<span class="op">(</span>ILI9341_MEMCONTROL<span class="op">,</span> ILI9341_MADCTL_MY <span class="op">|</span> ILI9341_MADCTL_BGR<span class="op">);</span></span>
<span id="cb10-200"><a href="#cb10-200" aria-hidden="true" tabindex="-1"></a>    lcdWrite8Reg<span class="op">(</span>ILI9341_PIXELFORMAT<span class="op">);</span></span>
<span id="cb10-201"><a href="#cb10-201" aria-hidden="true" tabindex="-1"></a>	lcdWrite8Data<span class="op">(</span><span class="bn">0x55</span><span class="op">);</span>lcdWrite8Data<span class="op">(</span><span class="bn">0x00</span><span class="op">);</span></span>
<span id="cb10-202"><a href="#cb10-202" aria-hidden="true" tabindex="-1"></a>    lcdWriteRegData16<span class="op">(</span>ILI9341_FRAMECONTROL<span class="op">,</span> <span class="bn">0x001B</span><span class="op">);</span></span>
<span id="cb10-203"><a href="#cb10-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-204"><a href="#cb10-204" aria-hidden="true" tabindex="-1"></a>    lcdWriteRegData8<span class="op">(</span>ILI9341_ENTRYMODE<span class="op">,</span> <span class="bn">0x07</span><span class="op">);</span></span>
<span id="cb10-205"><a href="#cb10-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-206"><a href="#cb10-206" aria-hidden="true" tabindex="-1"></a>    lcdWrite8Reg<span class="op">(</span>ILI9341_SLEEPOUT<span class="op">);</span></span>
<span id="cb10-207"><a href="#cb10-207" aria-hidden="true" tabindex="-1"></a>    delay<span class="op">(</span><span class="dv">150</span><span class="op">);</span></span>
<span id="cb10-208"><a href="#cb10-208" aria-hidden="true" tabindex="-1"></a>    lcdWrite8Reg<span class="op">(</span>ILI9341_DISPLAYON<span class="op">);</span></span>
<span id="cb10-209"><a href="#cb10-209" aria-hidden="true" tabindex="-1"></a>    delay<span class="op">(</span><span class="dv">500</span><span class="op">);</span></span>
<span id="cb10-210"><a href="#cb10-210" aria-hidden="true" tabindex="-1"></a>	setAddress<span class="op">(</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,*</span>_width<span class="op">-</span><span class="dv">1</span><span class="op">,*</span>_height<span class="op">-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb10-211"><a href="#cb10-211" aria-hidden="true" tabindex="-1"></a>     <span class="co">/************* Start Initial Sequence ILI9341 controller **********/</span></span>
<span id="cb10-212"><a href="#cb10-212" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-213"><a href="#cb10-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-214"><a href="#cb10-214" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> drawPixel<span class="op">(</span><span class="dt">uint16_t</span> x3<span class="op">,</span><span class="dt">uint16_t</span> y3<span class="op">,</span><span class="dt">uint16_t</span> color1<span class="op">)</span></span>
<span id="cb10-215"><a href="#cb10-215" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb10-216"><a href="#cb10-216" aria-hidden="true" tabindex="-1"></a>	setAddress<span class="op">(</span>x3<span class="op">,</span>y3<span class="op">,</span>x3<span class="op">+</span><span class="dv">1</span><span class="op">,</span>y3<span class="op">+</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb10-217"><a href="#cb10-217" aria-hidden="true" tabindex="-1"></a>    lcdWrite8Reg<span class="op">(</span>ILI9341_MEMORYWRITE<span class="op">);</span></span>
<span id="cb10-218"><a href="#cb10-218" aria-hidden="true" tabindex="-1"></a>	lcdWrite8Data<span class="op">(</span>color1<span class="op">&gt;&gt;</span><span class="dv">8</span><span class="op">);</span></span>
<span id="cb10-219"><a href="#cb10-219" aria-hidden="true" tabindex="-1"></a>	lcdWrite8Data<span class="op">(</span>color1<span class="op">);</span></span>
<span id="cb10-220"><a href="#cb10-220" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-221"><a href="#cb10-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-222"><a href="#cb10-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-223"><a href="#cb10-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-224"><a href="#cb10-224" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> drawCircle<span class="op">(</span><span class="dt">int16_t</span> x0<span class="op">,</span> <span class="dt">int16_t</span> y0<span class="op">,</span> <span class="dt">int16_t</span> r<span class="op">,</span> <span class="dt">uint16_t</span> color<span class="op">){</span></span>
<span id="cb10-225"><a href="#cb10-225" aria-hidden="true" tabindex="-1"></a>	<span class="dt">int</span> f <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> r<span class="op">;</span></span>
<span id="cb10-226"><a href="#cb10-226" aria-hidden="true" tabindex="-1"></a>    	<span class="dt">int</span> ddF_x <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb10-227"><a href="#cb10-227" aria-hidden="true" tabindex="-1"></a>    	<span class="dt">int</span> ddF_y <span class="op">=</span> <span class="op">-</span><span class="dv">2</span> <span class="op">*</span> r<span class="op">;</span></span>
<span id="cb10-228"><a href="#cb10-228" aria-hidden="true" tabindex="-1"></a>    	<span class="dt">int</span> x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-229"><a href="#cb10-229" aria-hidden="true" tabindex="-1"></a>    	<span class="dt">int</span> y <span class="op">=</span> r<span class="op">;</span></span>
<span id="cb10-230"><a href="#cb10-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-231"><a href="#cb10-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-232"><a href="#cb10-232" aria-hidden="true" tabindex="-1"></a>	drawPixel<span class="op">(</span>x0  <span class="op">,</span> y0<span class="op">+</span>r<span class="op">,</span> color<span class="op">);</span></span>
<span id="cb10-233"><a href="#cb10-233" aria-hidden="true" tabindex="-1"></a>    	drawPixel<span class="op">(</span>x0  <span class="op">,</span> y0<span class="op">-</span>r<span class="op">,</span> color<span class="op">);</span></span>
<span id="cb10-234"><a href="#cb10-234" aria-hidden="true" tabindex="-1"></a>    	drawPixel<span class="op">(</span>x0<span class="op">+</span>r<span class="op">,</span> y0  <span class="op">,</span> color<span class="op">);</span></span>
<span id="cb10-235"><a href="#cb10-235" aria-hidden="true" tabindex="-1"></a>    	drawPixel<span class="op">(</span>x0<span class="op">-</span>r<span class="op">,</span> y0  <span class="op">,</span> color<span class="op">);</span></span>
<span id="cb10-236"><a href="#cb10-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-237"><a href="#cb10-237" aria-hidden="true" tabindex="-1"></a>    	<span class="cf">while</span> <span class="op">(</span>x<span class="op">&lt;</span>y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-238"><a href="#cb10-238" aria-hidden="true" tabindex="-1"></a>        	<span class="cf">if</span> <span class="op">(</span>f <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-239"><a href="#cb10-239" aria-hidden="true" tabindex="-1"></a>            	y<span class="op">--;</span></span>
<span id="cb10-240"><a href="#cb10-240" aria-hidden="true" tabindex="-1"></a>            	ddF_y <span class="op">+=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb10-241"><a href="#cb10-241" aria-hidden="true" tabindex="-1"></a>            	f <span class="op">+=</span> ddF_y<span class="op">;</span></span>
<span id="cb10-242"><a href="#cb10-242" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb10-243"><a href="#cb10-243" aria-hidden="true" tabindex="-1"></a>        x<span class="op">++;</span></span>
<span id="cb10-244"><a href="#cb10-244" aria-hidden="true" tabindex="-1"></a>        ddF_x <span class="op">+=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb10-245"><a href="#cb10-245" aria-hidden="true" tabindex="-1"></a>        f <span class="op">+=</span> ddF_x<span class="op">;</span></span>
<span id="cb10-246"><a href="#cb10-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-247"><a href="#cb10-247" aria-hidden="true" tabindex="-1"></a>        drawPixel<span class="op">(</span>x0 <span class="op">+</span> x<span class="op">,</span> y0 <span class="op">+</span> y<span class="op">,</span> color<span class="op">);</span></span>
<span id="cb10-248"><a href="#cb10-248" aria-hidden="true" tabindex="-1"></a>        drawPixel<span class="op">(</span>x0 <span class="op">-</span> x<span class="op">,</span> y0 <span class="op">+</span> y<span class="op">,</span> color<span class="op">);</span></span>
<span id="cb10-249"><a href="#cb10-249" aria-hidden="true" tabindex="-1"></a>        drawPixel<span class="op">(</span>x0 <span class="op">+</span> x<span class="op">,</span> y0 <span class="op">-</span> y<span class="op">,</span> color<span class="op">);</span></span>
<span id="cb10-250"><a href="#cb10-250" aria-hidden="true" tabindex="-1"></a>        drawPixel<span class="op">(</span>x0 <span class="op">-</span> x<span class="op">,</span> y0 <span class="op">-</span> y<span class="op">,</span> color<span class="op">);</span></span>
<span id="cb10-251"><a href="#cb10-251" aria-hidden="true" tabindex="-1"></a>        drawPixel<span class="op">(</span>x0 <span class="op">+</span> y<span class="op">,</span> y0 <span class="op">+</span> x<span class="op">,</span> color<span class="op">);</span></span>
<span id="cb10-252"><a href="#cb10-252" aria-hidden="true" tabindex="-1"></a>        drawPixel<span class="op">(</span>x0 <span class="op">-</span> y<span class="op">,</span> y0 <span class="op">+</span> x<span class="op">,</span> color<span class="op">);</span></span>
<span id="cb10-253"><a href="#cb10-253" aria-hidden="true" tabindex="-1"></a>        drawPixel<span class="op">(</span>x0 <span class="op">+</span> y<span class="op">,</span> y0 <span class="op">-</span> x<span class="op">,</span> color<span class="op">);</span></span>
<span id="cb10-254"><a href="#cb10-254" aria-hidden="true" tabindex="-1"></a>        drawPixel<span class="op">(</span>x0 <span class="op">-</span> y<span class="op">,</span> y0 <span class="op">-</span> x<span class="op">,</span> color<span class="op">);</span></span>
<span id="cb10-255"><a href="#cb10-255" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb10-256"><a href="#cb10-256" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-257"><a href="#cb10-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-258"><a href="#cb10-258" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> fillRect<span class="op">(</span><span class="dt">uint16_t</span> x<span class="op">,</span><span class="dt">uint16_t</span> y<span class="op">,</span><span class="dt">uint16_t</span> w<span class="op">,</span><span class="dt">uint16_t</span> h<span class="op">,</span><span class="dt">uint16_t</span> color<span class="op">){</span></span>
<span id="cb10-259"><a href="#cb10-259" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> <span class="op">((</span>x <span class="op">&gt;=</span> <span class="op">*</span>_width<span class="op">)</span> <span class="op">||</span> <span class="op">(</span>y <span class="op">&gt;=</span> <span class="op">*</span>_height<span class="op">))</span></span>
<span id="cb10-260"><a href="#cb10-260" aria-hidden="true" tabindex="-1"></a>	<span class="op">{</span></span>
<span id="cb10-261"><a href="#cb10-261" aria-hidden="true" tabindex="-1"></a>		<span class="cf">return</span><span class="op">;</span></span>
<span id="cb10-262"><a href="#cb10-262" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb10-263"><a href="#cb10-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-264"><a href="#cb10-264" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> <span class="op">((</span>x<span class="op">+</span>w<span class="op">-</span><span class="dv">1</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="op">*</span>_width<span class="op">)</span></span>
<span id="cb10-265"><a href="#cb10-265" aria-hidden="true" tabindex="-1"></a>	<span class="op">{</span></span>
<span id="cb10-266"><a href="#cb10-266" aria-hidden="true" tabindex="-1"></a>		w <span class="op">=</span> <span class="op">*</span>_width<span class="op">-</span>x<span class="op">;</span></span>
<span id="cb10-267"><a href="#cb10-267" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb10-268"><a href="#cb10-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-269"><a href="#cb10-269" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> <span class="op">((</span>y<span class="op">+</span>h<span class="op">-</span><span class="dv">1</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="op">*</span>_height<span class="op">)</span></span>
<span id="cb10-270"><a href="#cb10-270" aria-hidden="true" tabindex="-1"></a>	<span class="op">{</span></span>
<span id="cb10-271"><a href="#cb10-271" aria-hidden="true" tabindex="-1"></a>		h <span class="op">=</span> <span class="op">*</span>_height<span class="op">-</span>y<span class="op">;</span></span>
<span id="cb10-272"><a href="#cb10-272" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb10-273"><a href="#cb10-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-274"><a href="#cb10-274" aria-hidden="true" tabindex="-1"></a>	setAddress<span class="op">(</span>x<span class="op">,</span> y<span class="op">,</span> x<span class="op">+</span>w<span class="op">-</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span>h<span class="op">-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb10-275"><a href="#cb10-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-276"><a href="#cb10-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-277"><a href="#cb10-277" aria-hidden="true" tabindex="-1"></a>	lcdWrite8Reg<span class="op">(</span>ILI9341_MEMORYWRITE<span class="op">);</span></span>
<span id="cb10-278"><a href="#cb10-278" aria-hidden="true" tabindex="-1"></a>	CD <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb10-279"><a href="#cb10-279" aria-hidden="true" tabindex="-1"></a>	<span class="cf">for</span><span class="op">(</span>y<span class="op">=</span>h<span class="op">;</span> y<span class="op">&gt;</span><span class="dv">0</span><span class="op">;</span> y<span class="op">--)</span></span>
<span id="cb10-280"><a href="#cb10-280" aria-hidden="true" tabindex="-1"></a>	<span class="op">{</span></span>
<span id="cb10-281"><a href="#cb10-281" aria-hidden="true" tabindex="-1"></a>		<span class="cf">for</span><span class="op">(</span>x<span class="op">=</span>w<span class="op">;</span> x<span class="op">&gt;</span><span class="dv">0</span><span class="op">;</span> x<span class="op">--)</span></span>
<span id="cb10-282"><a href="#cb10-282" aria-hidden="true" tabindex="-1"></a>		<span class="op">{</span></span>
<span id="cb10-283"><a href="#cb10-283" aria-hidden="true" tabindex="-1"></a>			lcdWrite8Data<span class="op">(</span>color<span class="op">&gt;&gt;</span><span class="dv">8</span><span class="op">);</span></span>
<span id="cb10-284"><a href="#cb10-284" aria-hidden="true" tabindex="-1"></a>			lcdWrite8Data<span class="op">(</span>color<span class="op">);</span></span>
<span id="cb10-285"><a href="#cb10-285" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span></span>
<span id="cb10-286"><a href="#cb10-286" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb10-287"><a href="#cb10-287" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-288"><a href="#cb10-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-289"><a href="#cb10-289" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> fillScreen<span class="op">(</span><span class="dt">void</span><span class="op">){</span></span>
<span id="cb10-290"><a href="#cb10-290" aria-hidden="true" tabindex="-1"></a>	<span class="dt">long</span> len <span class="op">=</span> <span class="dv">76800</span><span class="op">;</span></span>
<span id="cb10-291"><a href="#cb10-291" aria-hidden="true" tabindex="-1"></a>	<span class="dt">int</span> blocks <span class="op">=</span> <span class="dv">1200</span><span class="op">;</span></span>
<span id="cb10-292"><a href="#cb10-292" aria-hidden="true" tabindex="-1"></a>   	<span class="dt">uint8_t</span>  i<span class="op">,</span> hi <span class="op">=*</span>textbgcolor <span class="op">&gt;&gt;</span> <span class="dv">8</span><span class="op">;</span></span>
<span id="cb10-293"><a href="#cb10-293" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint8_t</span> lo <span class="op">=</span> <span class="op">*</span>textbgcolor<span class="op">;</span></span>
<span id="cb10-294"><a href="#cb10-294" aria-hidden="true" tabindex="-1"></a>	setAddress<span class="op">(</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,*</span>_width<span class="op">-</span><span class="dv">1</span><span class="op">,*</span>_height<span class="op">-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb10-295"><a href="#cb10-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-296"><a href="#cb10-296" aria-hidden="true" tabindex="-1"></a>	lcdWrite8Reg<span class="op">(</span>ILI9341_MEMORYWRITE<span class="op">);</span></span>
<span id="cb10-297"><a href="#cb10-297" aria-hidden="true" tabindex="-1"></a>	lcdWrite8Data<span class="op">(</span>hi<span class="op">);</span></span>
<span id="cb10-298"><a href="#cb10-298" aria-hidden="true" tabindex="-1"></a>	lcdWrite8Data<span class="op">(</span>lo<span class="op">);</span></span>
<span id="cb10-299"><a href="#cb10-299" aria-hidden="true" tabindex="-1"></a>	len<span class="op">--;</span></span>
<span id="cb10-300"><a href="#cb10-300" aria-hidden="true" tabindex="-1"></a>	IOM <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb10-301"><a href="#cb10-301" aria-hidden="true" tabindex="-1"></a>	<span class="cf">while</span><span class="op">(</span>blocks<span class="op">--)</span> <span class="op">{</span></span>
<span id="cb10-302"><a href="#cb10-302" aria-hidden="true" tabindex="-1"></a>      i <span class="op">=</span> <span class="dv">16</span><span class="op">;</span></span>
<span id="cb10-303"><a href="#cb10-303" aria-hidden="true" tabindex="-1"></a>      <span class="cf">do</span> <span class="op">{</span></span>
<span id="cb10-304"><a href="#cb10-304" aria-hidden="true" tabindex="-1"></a>      		<span class="op">*</span>lcd_address <span class="op">=</span> hi<span class="op">;*</span>lcd_address <span class="op">=</span> lo<span class="op">;</span></span>
<span id="cb10-305"><a href="#cb10-305" aria-hidden="true" tabindex="-1"></a>      		<span class="op">*</span>lcd_address <span class="op">=</span> hi<span class="op">;*</span>lcd_address <span class="op">=</span> lo<span class="op">;</span></span>
<span id="cb10-306"><a href="#cb10-306" aria-hidden="true" tabindex="-1"></a>      		<span class="op">*</span>lcd_address <span class="op">=</span> hi<span class="op">;*</span>lcd_address <span class="op">=</span> lo<span class="op">;</span></span>
<span id="cb10-307"><a href="#cb10-307" aria-hidden="true" tabindex="-1"></a>      		<span class="op">*</span>lcd_address <span class="op">=</span> hi<span class="op">;*</span>lcd_address <span class="op">=</span> lo<span class="op">;</span></span>
<span id="cb10-308"><a href="#cb10-308" aria-hidden="true" tabindex="-1"></a>      <span class="op">}</span> <span class="cf">while</span><span class="op">(--</span>i<span class="op">);</span></span>
<span id="cb10-309"><a href="#cb10-309" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb10-310"><a href="#cb10-310" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span>i <span class="op">=</span> <span class="op">(</span><span class="dt">char</span><span class="op">)</span>len <span class="op">&amp;</span> <span class="dv">63</span><span class="op">;</span> i<span class="op">--;</span> <span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-311"><a href="#cb10-311" aria-hidden="true" tabindex="-1"></a>    	<span class="op">*</span>lcd_address <span class="op">=</span> hi<span class="op">;*</span>lcd_address <span class="op">=</span> lo<span class="op">;</span></span>
<span id="cb10-312"><a href="#cb10-312" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb10-313"><a href="#cb10-313" aria-hidden="true" tabindex="-1"></a>    IOM <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-314"><a href="#cb10-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-315"><a href="#cb10-315" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-316"><a href="#cb10-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-317"><a href="#cb10-317" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> clearLCD<span class="op">(</span><span class="dt">void</span><span class="op">){</span></span>
<span id="cb10-318"><a href="#cb10-318" aria-hidden="true" tabindex="-1"></a>	fillScreen<span class="op">();</span></span>
<span id="cb10-319"><a href="#cb10-319" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb10-320"><a href="#cb10-320" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-321"><a href="#cb10-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-322"><a href="#cb10-322" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> drawChar<span class="op">(</span><span class="dt">uint8_t</span> c<span class="op">){</span></span>
<span id="cb10-323"><a href="#cb10-323" aria-hidden="true" tabindex="-1"></a>	<span class="dt">int16_t</span> x <span class="op">=</span> <span class="op">*</span>cursor_x<span class="op">;</span></span>
<span id="cb10-324"><a href="#cb10-324" aria-hidden="true" tabindex="-1"></a>	<span class="dt">int16_t</span> y <span class="op">=</span> <span class="op">*</span>cursor_y<span class="op">;</span></span>
<span id="cb10-325"><a href="#cb10-325" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint16_t</span> color <span class="op">=</span> <span class="op">*</span>textcolor<span class="op">;</span></span>
<span id="cb10-326"><a href="#cb10-326" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint16_t</span> bg <span class="op">=</span> <span class="op">*</span>textbgcolor<span class="op">;</span></span>
<span id="cb10-327"><a href="#cb10-327" aria-hidden="true" tabindex="-1"></a>	<span class="dt">int8_t</span> size <span class="op">=</span> <span class="op">*</span>textsize<span class="op">;</span></span>
<span id="cb10-328"><a href="#cb10-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-329"><a href="#cb10-329" aria-hidden="true" tabindex="-1"></a>	<span class="dt">int8_t</span> i<span class="op">,</span> j<span class="op">;</span></span>
<span id="cb10-330"><a href="#cb10-330" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> line<span class="op">;</span></span>
<span id="cb10-331"><a href="#cb10-331" aria-hidden="true" tabindex="-1"></a>	<span class="cf">for</span> <span class="op">(</span>i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span><span class="dv">6</span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb10-332"><a href="#cb10-332" aria-hidden="true" tabindex="-1"></a>	<span class="op">{</span></span>
<span id="cb10-333"><a href="#cb10-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-334"><a href="#cb10-334" aria-hidden="true" tabindex="-1"></a>		<span class="cf">if</span> <span class="op">(</span>i <span class="op">==</span> <span class="dv">5</span><span class="op">)</span></span>
<span id="cb10-335"><a href="#cb10-335" aria-hidden="true" tabindex="-1"></a>		<span class="op">{</span></span>
<span id="cb10-336"><a href="#cb10-336" aria-hidden="true" tabindex="-1"></a>			line <span class="op">=</span> <span class="bn">0x0</span><span class="op">;</span></span>
<span id="cb10-337"><a href="#cb10-337" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span></span>
<span id="cb10-338"><a href="#cb10-338" aria-hidden="true" tabindex="-1"></a>		<span class="cf">else</span></span>
<span id="cb10-339"><a href="#cb10-339" aria-hidden="true" tabindex="-1"></a>		<span class="op">{</span></span>
<span id="cb10-340"><a href="#cb10-340" aria-hidden="true" tabindex="-1"></a>			line <span class="op">=</span> pgm_read_byte<span class="op">(</span>font<span class="op">+(</span>c<span class="op">*</span><span class="dv">5</span><span class="op">)+</span>i<span class="op">);</span></span>
<span id="cb10-341"><a href="#cb10-341" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span></span>
<span id="cb10-342"><a href="#cb10-342" aria-hidden="true" tabindex="-1"></a>		<span class="cf">for</span> <span class="op">(</span>j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j<span class="op">&lt;</span><span class="dv">8</span><span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb10-343"><a href="#cb10-343" aria-hidden="true" tabindex="-1"></a>		<span class="op">{</span></span>
<span id="cb10-344"><a href="#cb10-344" aria-hidden="true" tabindex="-1"></a>			<span class="cf">if</span> <span class="op">(</span>line <span class="op">&amp;</span> <span class="bn">0x1</span><span class="op">)</span></span>
<span id="cb10-345"><a href="#cb10-345" aria-hidden="true" tabindex="-1"></a>			<span class="op">{</span></span>
<span id="cb10-346"><a href="#cb10-346" aria-hidden="true" tabindex="-1"></a>				<span class="cf">if</span> <span class="op">(</span>size <span class="op">==</span> <span class="dv">1</span><span class="op">)</span></span>
<span id="cb10-347"><a href="#cb10-347" aria-hidden="true" tabindex="-1"></a>				<span class="op">{</span></span>
<span id="cb10-348"><a href="#cb10-348" aria-hidden="true" tabindex="-1"></a>					drawPixel<span class="op">(</span>x<span class="op">+</span>i<span class="op">,</span> y<span class="op">+</span>j<span class="op">,</span> color<span class="op">);</span></span>
<span id="cb10-349"><a href="#cb10-349" aria-hidden="true" tabindex="-1"></a>				<span class="op">}</span></span>
<span id="cb10-350"><a href="#cb10-350" aria-hidden="true" tabindex="-1"></a>				<span class="cf">else</span> <span class="op">{</span></span>
<span id="cb10-351"><a href="#cb10-351" aria-hidden="true" tabindex="-1"></a>					fillRect<span class="op">(</span>x<span class="op">+(</span>i<span class="op">*</span>size<span class="op">),</span> y<span class="op">+(</span>j<span class="op">*</span>size<span class="op">),</span> size<span class="op">,</span> size<span class="op">,</span> color<span class="op">);</span></span>
<span id="cb10-352"><a href="#cb10-352" aria-hidden="true" tabindex="-1"></a>				<span class="op">}</span></span>
<span id="cb10-353"><a href="#cb10-353" aria-hidden="true" tabindex="-1"></a>			<span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>bg <span class="op">!=</span> color<span class="op">)</span></span>
<span id="cb10-354"><a href="#cb10-354" aria-hidden="true" tabindex="-1"></a>			<span class="op">{</span></span>
<span id="cb10-355"><a href="#cb10-355" aria-hidden="true" tabindex="-1"></a>				<span class="cf">if</span> <span class="op">(</span>size <span class="op">==</span> <span class="dv">1</span><span class="op">)</span></span>
<span id="cb10-356"><a href="#cb10-356" aria-hidden="true" tabindex="-1"></a>				<span class="op">{</span></span>
<span id="cb10-357"><a href="#cb10-357" aria-hidden="true" tabindex="-1"></a>					drawPixel<span class="op">(</span>x<span class="op">+</span>i<span class="op">,</span> y<span class="op">+</span>j<span class="op">,</span> bg<span class="op">);</span></span>
<span id="cb10-358"><a href="#cb10-358" aria-hidden="true" tabindex="-1"></a>				<span class="op">}</span></span>
<span id="cb10-359"><a href="#cb10-359" aria-hidden="true" tabindex="-1"></a>				<span class="cf">else</span></span>
<span id="cb10-360"><a href="#cb10-360" aria-hidden="true" tabindex="-1"></a>				<span class="op">{</span></span>
<span id="cb10-361"><a href="#cb10-361" aria-hidden="true" tabindex="-1"></a>					fillRect<span class="op">(</span>x<span class="op">+</span>i<span class="op">*</span>size<span class="op">,</span> y<span class="op">+</span>j<span class="op">*</span>size<span class="op">,</span> size<span class="op">,</span> size<span class="op">,</span> bg<span class="op">);</span></span>
<span id="cb10-362"><a href="#cb10-362" aria-hidden="true" tabindex="-1"></a>				<span class="op">}</span></span>
<span id="cb10-363"><a href="#cb10-363" aria-hidden="true" tabindex="-1"></a>			<span class="op">}</span></span>
<span id="cb10-364"><a href="#cb10-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-365"><a href="#cb10-365" aria-hidden="true" tabindex="-1"></a>			line <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb10-366"><a href="#cb10-366" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span></span>
<span id="cb10-367"><a href="#cb10-367" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb10-368"><a href="#cb10-368" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-369"><a href="#cb10-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-370"><a href="#cb10-370" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> printChar<span class="op">(</span><span class="dt">uint8_t</span> c<span class="op">)</span></span>
<span id="cb10-371"><a href="#cb10-371" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb10-372"><a href="#cb10-372" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> <span class="op">(</span>c <span class="op">==</span> <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span><span class="op">)</span></span>
<span id="cb10-373"><a href="#cb10-373" aria-hidden="true" tabindex="-1"></a>	<span class="op">{</span></span>
<span id="cb10-374"><a href="#cb10-374" aria-hidden="true" tabindex="-1"></a>		<span class="op">*</span>cursor_y <span class="op">+=</span> <span class="op">*</span>textsize<span class="op">*</span><span class="dv">8</span><span class="op">;</span></span>
<span id="cb10-375"><a href="#cb10-375" aria-hidden="true" tabindex="-1"></a>		<span class="op">*</span>cursor_x  <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-376"><a href="#cb10-376" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb10-377"><a href="#cb10-377" aria-hidden="true" tabindex="-1"></a>	<span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>c <span class="op">==</span> <span class="ch">&#39;</span><span class="sc">\r</span><span class="ch">&#39;</span><span class="op">)</span></span>
<span id="cb10-378"><a href="#cb10-378" aria-hidden="true" tabindex="-1"></a>	<span class="op">{</span></span>
<span id="cb10-379"><a href="#cb10-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-380"><a href="#cb10-380" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb10-381"><a href="#cb10-381" aria-hidden="true" tabindex="-1"></a>	<span class="cf">else</span></span>
<span id="cb10-382"><a href="#cb10-382" aria-hidden="true" tabindex="-1"></a>	<span class="op">{</span></span>
<span id="cb10-383"><a href="#cb10-383" aria-hidden="true" tabindex="-1"></a>		drawChar<span class="op">(</span>c<span class="op">);</span></span>
<span id="cb10-384"><a href="#cb10-384" aria-hidden="true" tabindex="-1"></a>		<span class="op">*</span>cursor_x <span class="op">+=</span> <span class="op">*</span>textsize<span class="op">*</span><span class="dv">6</span><span class="op">;</span></span>
<span id="cb10-385"><a href="#cb10-385" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb10-386"><a href="#cb10-386" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-387"><a href="#cb10-387" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> printString<span class="op">(</span><span class="dt">char</span> <span class="op">*</span>str<span class="op">)</span></span>
<span id="cb10-388"><a href="#cb10-388" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb10-389"><a href="#cb10-389" aria-hidden="true" tabindex="-1"></a>	<span class="dt">int16_t</span> i<span class="op">;</span></span>
<span id="cb10-390"><a href="#cb10-390" aria-hidden="true" tabindex="-1"></a>	<span class="cf">for</span><span class="op">(</span>i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>str<span class="op">[</span>i<span class="op">]!=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">++)</span>	<span class="co">/* Send each char of string till the NULL */</span></span>
<span id="cb10-391"><a href="#cb10-391" aria-hidden="true" tabindex="-1"></a>	<span class="op">{</span></span>
<span id="cb10-392"><a href="#cb10-392" aria-hidden="true" tabindex="-1"></a>		printChar<span class="op">(</span>str<span class="op">[</span>i<span class="op">]);</span>	<span class="co">/* Call transmit data function */</span></span>
<span id="cb10-393"><a href="#cb10-393" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb10-394"><a href="#cb10-394" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-395"><a href="#cb10-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-396"><a href="#cb10-396" aria-hidden="true" tabindex="-1"></a><span class="dt">uint16_t</span> reverse<span class="op">(</span><span class="dt">uint8_t</span> d<span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-397"><a href="#cb10-397" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint16_t</span> rev <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-398"><a href="#cb10-398" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint16_t</span> val <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-399"><a href="#cb10-399" aria-hidden="true" tabindex="-1"></a>	<span class="cf">while</span><span class="op">(</span>d <span class="op">&gt;=</span> <span class="dv">1</span><span class="op">){</span></span>
<span id="cb10-400"><a href="#cb10-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-401"><a href="#cb10-401" aria-hidden="true" tabindex="-1"></a>		val <span class="op">=</span> d<span class="op">%</span><span class="dv">10</span><span class="op">;</span></span>
<span id="cb10-402"><a href="#cb10-402" aria-hidden="true" tabindex="-1"></a>		d <span class="op">=</span> d<span class="op">/</span><span class="dv">10</span><span class="op">;</span></span>
<span id="cb10-403"><a href="#cb10-403" aria-hidden="true" tabindex="-1"></a>		rev <span class="op">=</span> rev <span class="op">*</span> <span class="dv">10</span> <span class="op">+</span> val<span class="op">;</span></span>
<span id="cb10-404"><a href="#cb10-404" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb10-405"><a href="#cb10-405" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> rev<span class="op">;</span></span>
<span id="cb10-406"><a href="#cb10-406" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-407"><a href="#cb10-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-408"><a href="#cb10-408" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> asciiToDec<span class="op">(</span><span class="dt">uint8_t</span> d<span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-409"><a href="#cb10-409" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> val<span class="op">;</span></span>
<span id="cb10-410"><a href="#cb10-410" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint16_t</span> id<span class="op">;</span></span>
<span id="cb10-411"><a href="#cb10-411" aria-hidden="true" tabindex="-1"></a>	id <span class="op">=</span> reverse<span class="op">(</span>d<span class="op">);</span></span>
<span id="cb10-412"><a href="#cb10-412" aria-hidden="true" tabindex="-1"></a>	<span class="cf">while</span> <span class="op">(</span>id <span class="op">&gt;=</span> <span class="dv">1</span><span class="op">){</span></span>
<span id="cb10-413"><a href="#cb10-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-414"><a href="#cb10-414" aria-hidden="true" tabindex="-1"></a>		val <span class="op">=</span> id <span class="op">%</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb10-415"><a href="#cb10-415" aria-hidden="true" tabindex="-1"></a>		id <span class="op">=</span> id<span class="op">/</span><span class="dv">10</span><span class="op">;</span></span>
<span id="cb10-416"><a href="#cb10-416" aria-hidden="true" tabindex="-1"></a>		printChar<span class="op">(</span>val <span class="op">+</span> <span class="ch">&#39;0&#39;</span><span class="op">);</span></span>
<span id="cb10-417"><a href="#cb10-417" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb10-418"><a href="#cb10-418" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-419"><a href="#cb10-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-420"><a href="#cb10-420" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> asciiToHex<span class="op">(</span><span class="dt">uint8_t</span> d<span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-421"><a href="#cb10-421" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> val<span class="op">;</span></span>
<span id="cb10-422"><a href="#cb10-422" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> store<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb10-423"><a href="#cb10-423" aria-hidden="true" tabindex="-1"></a>	store<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-424"><a href="#cb10-424" aria-hidden="true" tabindex="-1"></a>	store<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-425"><a href="#cb10-425" aria-hidden="true" tabindex="-1"></a>	val <span class="op">=</span> d <span class="op">&amp;</span> <span class="bn">0x0F</span><span class="op">;</span></span>
<span id="cb10-426"><a href="#cb10-426" aria-hidden="true" tabindex="-1"></a>	d <span class="op">=</span> d <span class="op">&gt;&gt;</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb10-427"><a href="#cb10-427" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> <span class="op">(</span>val <span class="op">&lt;=</span> <span class="dv">9</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-428"><a href="#cb10-428" aria-hidden="true" tabindex="-1"></a>		store<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> val <span class="op">+</span> <span class="ch">&#39;0&#39;</span><span class="op">;</span></span>
<span id="cb10-429"><a href="#cb10-429" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb10-430"><a href="#cb10-430" aria-hidden="true" tabindex="-1"></a>	<span class="cf">else</span> <span class="op">{</span></span>
<span id="cb10-431"><a href="#cb10-431" aria-hidden="true" tabindex="-1"></a>		store<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="op">(</span>val<span class="op">%</span><span class="dv">10</span><span class="op">)</span> <span class="op">+</span> <span class="ch">&#39;A&#39;</span><span class="op">;</span></span>
<span id="cb10-432"><a href="#cb10-432" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb10-433"><a href="#cb10-433" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> <span class="op">(</span>d <span class="op">&lt;=</span> <span class="dv">9</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-434"><a href="#cb10-434" aria-hidden="true" tabindex="-1"></a>		store<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> d <span class="op">+</span> <span class="ch">&#39;0&#39;</span><span class="op">;</span></span>
<span id="cb10-435"><a href="#cb10-435" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb10-436"><a href="#cb10-436" aria-hidden="true" tabindex="-1"></a>	<span class="cf">else</span> <span class="op">{</span></span>
<span id="cb10-437"><a href="#cb10-437" aria-hidden="true" tabindex="-1"></a>		store<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="op">(</span>d<span class="op">%</span><span class="dv">10</span><span class="op">)</span> <span class="op">+</span> <span class="ch">&#39;A&#39;</span><span class="op">;</span></span>
<span id="cb10-438"><a href="#cb10-438" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb10-439"><a href="#cb10-439" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span>store<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb10-440"><a href="#cb10-440" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span>store<span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb10-441"><a href="#cb10-441" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-442"><a href="#cb10-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-443"><a href="#cb10-443" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> errorBackToMenu<span class="op">(</span><span class="dt">char</span><span class="op">*</span> message<span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-444"><a href="#cb10-444" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">191</span><span class="op">);</span></span>
<span id="cb10-445"><a href="#cb10-445" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span>message<span class="op">);</span></span>
<span id="cb10-446"><a href="#cb10-446" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">216</span><span class="op">);</span></span>
<span id="cb10-447"><a href="#cb10-447" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;&lt;1 Back to Menu&quot;</span><span class="op">);</span></span>
<span id="cb10-448"><a href="#cb10-448" aria-hidden="true" tabindex="-1"></a>	waitForKey<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb10-449"><a href="#cb10-449" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb11" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">// associated header file</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Memory.h&quot;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">// including standard headers and portable datatypes</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;8051.h&quot;</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Bool.h&quot;</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;LCD.h&quot;</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> readFromExternalAddress<span class="op">(</span><span class="dt">uint16_t</span> address<span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>	<span class="co">// load our data pointer with the incoming address before we jump to assembly</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>	DPH <span class="op">=</span> <span class="op">(</span>address <span class="op">&gt;&gt;</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>	DPL <span class="op">=</span> address<span class="op">;</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>	__asm</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>		MOVX A<span class="op">,</span> @DPTR</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>	__endasm<span class="op">;</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> value <span class="op">=</span> ACC<span class="op">;</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> value<span class="op">;</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> writeToExternalAddress<span class="op">(</span><span class="dt">uint16_t</span> address<span class="op">,</span> <span class="dt">uint8_t</span> value<span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>	<span class="co">// load our data pointer with the incoming address and A with the value before we jump to assembly</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>	DPH <span class="op">=</span> <span class="op">(</span>address <span class="op">&gt;&gt;</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>	DPL <span class="op">=</span> address<span class="op">;</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>	ACC <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>	__asm</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>		MOVX @DPTR<span class="op">,</span> A</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>	__endasm<span class="op">;</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span><span class="op">;</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="dt">uint16_t</span> searchForwardForExternalValue<span class="op">(</span><span class="dt">uint16_t</span> address<span class="op">,</span> <span class="dt">uint8_t</span> value<span class="op">,</span> <span class="dt">bool</span><span class="op">*</span> success<span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>	<span class="co">// starting at our current address, we&#39;ll compare each byte to our value</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>	<span class="co">// if we find it, we&#39;ll set success true and return with the current address</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>	<span class="co">// otherwise, we&#39;ll increment the address and continue</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>	<span class="co">// if we reach the end of the memory block, we&#39;ll set success false and return</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>	<span class="cf">for</span> <span class="op">(</span>address<span class="op">;</span> address <span class="op">+</span> <span class="dv">1</span> <span class="op">&gt;</span> <span class="dv">0</span><span class="op">;</span> address<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>		<span class="dt">uint8_t</span> currentValue <span class="op">=</span> readFromExternalAddress<span class="op">(</span>address<span class="op">);</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>		<span class="cf">if</span> <span class="op">(</span>currentValue <span class="op">==</span> value<span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>			<span class="op">*</span>success <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> address<span class="op">;</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>	success <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a><span class="dt">uint16_t</span> searchBackwardForExternalValue<span class="op">(</span><span class="dt">uint16_t</span> address<span class="op">,</span> <span class="dt">uint8_t</span> value<span class="op">,</span> <span class="dt">bool</span><span class="op">*</span> success<span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>	<span class="cf">for</span> <span class="op">(</span>address<span class="op">;</span> address <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;</span> <span class="bn">0xFFFF</span><span class="op">;</span> address<span class="op">--)</span> <span class="op">{</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>		<span class="dt">uint8_t</span> currentValue <span class="op">=</span> readFromExternalAddress<span class="op">(</span>address<span class="op">);</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>		<span class="cf">if</span> <span class="op">(</span>currentValue <span class="op">==</span> value<span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>			<span class="op">*</span>success <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> address<span class="op">;</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>	success <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a><span class="dt">uint16_t</span> searchRangeForValue<span class="op">(</span><span class="dt">uint16_t</span> startAddress<span class="op">,</span> <span class="dt">uint16_t</span> endAddress<span class="op">,</span> <span class="dt">uint8_t</span> value<span class="op">,</span> <span class="dt">bool</span><span class="op">*</span> success<span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>	<span class="cf">for</span> <span class="op">(</span>startAddress<span class="op">;</span> startAddress <span class="op">&lt;=</span> endAddress<span class="op">;</span> startAddress<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>		<span class="dt">uint8_t</span> readValue <span class="op">=</span> readFromExternalAddress<span class="op">(</span>startAddress<span class="op">);</span></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>		<span class="cf">if</span> <span class="op">(</span>readValue <span class="op">==</span> value<span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>			<span class="op">*</span>success <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> startAddress<span class="op">;</span></span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>	<span class="op">*</span>success <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a><span class="dt">uint16_t</span> countValueInRange<span class="op">(</span><span class="dt">uint16_t</span> startAddress<span class="op">,</span> <span class="dt">uint16_t</span> endAddress<span class="op">,</span> <span class="dt">uint8_t</span> value<span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint16_t</span> count <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>	<span class="cf">for</span> <span class="op">(</span>startAddress<span class="op">;</span> startAddress <span class="op">&lt;</span> endAddress<span class="op">;</span> startAddress<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>		<span class="dt">uint8_t</span> readValue <span class="op">=</span> readFromExternalAddress<span class="op">(</span>startAddress<span class="op">);</span></span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>		<span class="cf">if</span> <span class="op">(</span>readValue <span class="op">==</span> value<span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>			count<span class="op">++;</span></span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span></span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>	<span class="co">// quick final check</span></span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> <span class="op">(</span>startAddress <span class="op">==</span> <span class="bn">0xFFFF</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>		<span class="dt">uint8_t</span> readValue <span class="op">=</span> readFromExternalAddress<span class="op">(</span>startAddress<span class="op">);</span></span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>		<span class="cf">if</span> <span class="op">(</span>readValue <span class="op">==</span> value<span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>			count<span class="op">++;</span></span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span></span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> count<span class="op">;</span></span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb12" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">// associated header file</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Menu.h&quot;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">// including standard headers and portable datatypes</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;8051.h&quot;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;LCD.h&quot;</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Keypad.h&quot;</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Utils.h&quot;</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Constants.h&quot;</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;RTC.h&quot;</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>__code <span class="dt">uint16_t</span> futurama<span class="op">[]</span> <span class="op">=</span> <span class="op">{</span><span class="bn">0x10C3</span><span class="op">,</span><span class="bn">0x2146</span><span class="op">,</span><span class="bn">0x2146</span><span class="op">,</span><span class="bn">0x2146</span><span class="op">,</span><span class="bn">0x1945</span><span class="op">,</span><span class="bn">0x2146</span><span class="op">,</span><span class="bn">0x2146</span><span class="op">,</span><span class="bn">0x2146</span><span class="op">,</span><span class="bn">0x2146</span><span class="op">,</span><span class="bn">0x2146</span><span class="op">,</span><span class="bn">0x1945</span><span class="op">,</span><span class="bn">0x1945</span><span class="op">,</span><span class="bn">0x2146</span><span class="op">,</span><span class="bn">0x2146</span><span class="op">,</span><span class="bn">0x2146</span><span class="op">,</span><span class="bn">0x2146</span><span class="op">,</span><span class="bn">0x1945</span><span class="op">};</span> <span class="co">// full array omitted for brevity</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> titleScreen<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">60</span><span class="op">,</span> <span class="dv">70</span><span class="op">);</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;  Carter Brehm  &quot;</span><span class="op">);</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">60</span><span class="op">,</span> <span class="dv">150</span><span class="op">);</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot; ECEN 433    *&gt; &quot;</span><span class="op">);</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>	<span class="co">// we don&#39;t care what button they press here</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>	<span class="cf">while</span> <span class="op">(</span>readKeypad<span class="op">()</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>		setCursor<span class="op">(</span><span class="dv">50</span><span class="op">,</span> <span class="dv">216</span><span class="op">);</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>		rtcPrint<span class="op">();</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>	clearLCD<span class="op">();</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> fryScreen<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint16_t</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint16_t</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint16_t</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>	<span class="cf">while</span> <span class="op">(</span>i <span class="op">&lt;</span> <span class="dv">19200</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>		<span class="co">//drawPixel(2*j, 2*k, futurama[i]);</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>		fillRect<span class="op">(</span><span class="dv">2</span><span class="op">*</span>j<span class="op">,</span> <span class="dv">2</span><span class="op">*</span>k<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> futurama<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>		j<span class="op">++;</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>		i<span class="op">++;</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>		<span class="cf">if</span> <span class="op">(</span>j <span class="op">==</span> <span class="dv">160</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>			j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>			k<span class="op">++;</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">30</span><span class="op">,</span> <span class="dv">216</span><span class="op">);</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>	setTextColor<span class="op">(</span>WHITE<span class="op">,</span> BLACK<span class="op">);</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;I.C. Wiener? Oh, crud.&quot;</span><span class="op">);</span></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>	<span class="cf">while</span> <span class="op">(</span>readKeypad<span class="op">()</span> <span class="op">==</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>	setTextColor<span class="op">(</span>WHITE<span class="op">,</span> GREEN<span class="op">);</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> menu<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>	clearLCD<span class="op">();</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">85</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;Menu Options&quot;</span><span class="op">);</span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>	<span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> menuCount<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>		setCursor<span class="op">(</span><span class="dv">80</span><span class="op">,</span> <span class="op">(</span>i<span class="op">+</span><span class="dv">2</span><span class="op">)*</span><span class="dv">24</span><span class="op">);</span></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>		printString<span class="op">(</span>menuOptions<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>	<span class="cf">while</span> <span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>		<span class="dt">uint8_t</span> menuChoice <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>		<span class="cf">if</span> <span class="op">((</span>menuChoice <span class="op">&gt;=</span> <span class="bn">0x0A</span> <span class="op">&amp;&amp;</span> menuChoice <span class="op">&lt;=</span> <span class="bn">0x0F</span><span class="op">)</span> <span class="op">||</span> <span class="op">(</span>menuChoice <span class="op">&gt;=</span> <span class="bn">0x01</span> <span class="op">&amp;&amp;</span> menuChoice <span class="op">&lt;=</span> <span class="bn">0x03</span><span class="op">))</span> <span class="op">{</span> <span class="co">// return the user&#39;s choice</span></span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>			clearLCD<span class="op">();</span></span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> menuChoice<span class="op">;</span></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>			menuChoice <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span></span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> blockSizeMenu<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>	clearLCD<span class="op">();</span></span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">85</span><span class="op">,</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;Block Size&quot;</span><span class="op">);</span></span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>	<span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> blockSizeMenuCount<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a>		setCursor<span class="op">(</span><span class="dv">70</span><span class="op">,</span> <span class="op">(</span>i<span class="op">+</span><span class="dv">3</span><span class="op">)*</span><span class="dv">25</span><span class="op">);</span></span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a>		printString<span class="op">(</span>blockSizeMenuOptions<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>	<span class="cf">while</span> <span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a>		<span class="dt">uint8_t</span> menuChoice <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a>		<span class="cf">if</span> <span class="op">(</span>menuChoice <span class="op">&gt;=</span> <span class="bn">0x0A</span> <span class="op">&amp;&amp;</span> menuChoice <span class="op">&lt;=</span> <span class="bn">0x0F</span><span class="op">)</span> <span class="op">{</span> <span class="co">// return the user&#39;s choice</span></span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a>			clearLCD<span class="op">();</span></span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a>			<span class="cf">return</span> menuChoice<span class="op">;</span></span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a>			menuChoice <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a>		<span class="op">}</span></span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb13" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">// associated header file</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Move.h&quot;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">// including standard headers and portable datatypes</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;8051.h&quot;</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;LCD.h&quot;</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Keypad.h&quot;</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Utils.h&quot;</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Menu.h&quot;</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Memory.h&quot;</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> move<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint16_t</span> srcAddress <span class="op">=</span> promptForWord<span class="op">(</span><span class="st">&quot;Src Address?&quot;</span><span class="op">);</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> blockSize <span class="op">=</span> blockSizeMenu<span class="op">();</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint16_t</span> blockQuantity <span class="op">=</span> promptForWord<span class="op">(</span><span class="st">&quot;Block Quantity?&quot;</span><span class="op">);</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>	<span class="co">// quick check to make sure they didn&#39;t want zero blocks</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>	<span class="cf">while</span> <span class="op">(!</span>blockQuantity<span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>		blockQuantity <span class="op">=</span> promptForWord<span class="op">(</span><span class="st">&quot;Quantity &gt; 0!&quot;</span><span class="op">);</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>	<span class="co">// turns the user&#39;s block size from a letter choice to a number</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>	<span class="cf">switch</span> <span class="op">(</span>blockSize<span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="bn">0x0B</span><span class="op">:</span> <span class="co">// word</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>			blockSize <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="bn">0x0C</span><span class="op">:</span> <span class="co">// double word</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>			blockSize <span class="op">=</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>		<span class="cf">case</span> <span class="bn">0x0D</span><span class="op">:</span> <span class="co">// quad word!</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>			blockSize <span class="op">=</span> <span class="dv">8</span><span class="op">;</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>		<span class="cf">default</span><span class="op">:</span> <span class="co">// byte</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>			blockSize <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>			<span class="cf">break</span><span class="op">;</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>	clearLCD<span class="op">();</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint16_t</span> totalBytes <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>	<span class="co">// check for if our block of memory will be too big</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> <span class="op">(</span>blockSize <span class="op">*</span> blockQuantity <span class="op">&lt;</span> blockSize<span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>		errorBackToMenu<span class="op">(</span><span class="st">&quot;Block Overflow!&quot;</span><span class="op">);</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>		<span class="cf">return</span><span class="op">;</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>		totalBytes <span class="op">=</span> blockSize <span class="op">*</span> blockQuantity<span class="op">;</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>	<span class="co">// sanity checks to make sure we won&#39;t overflow</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> <span class="op">(</span>srcAddress <span class="op">+</span> <span class="op">(</span>totalBytes<span class="op">)</span> <span class="op">&lt;</span> srcAddress<span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>		errorBackToMenu<span class="op">(</span><span class="st">&quot;Src Overflow!&quot;</span><span class="op">);</span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>		<span class="cf">return</span><span class="op">;</span></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint16_t</span> destAddress <span class="op">=</span> promptForWord<span class="op">(</span><span class="st">&quot;Dest Address?&quot;</span><span class="op">);</span></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> <span class="op">(</span>destAddress <span class="op">+</span> <span class="op">(</span>totalBytes<span class="op">)</span> <span class="op">&lt;</span> destAddress<span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>		errorBackToMenu<span class="op">(</span><span class="st">&quot;Dest Overflow!&quot;</span><span class="op">);</span></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>		<span class="cf">return</span><span class="op">;</span></span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>	clearLCD<span class="op">();</span></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>	<span class="co">// XXXX * Y bytes</span></span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;Moving &quot;</span><span class="op">);</span></span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>	printHexWordToASCIIArray<span class="op">(</span>blockQuantity<span class="op">);</span></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot; * &quot;</span><span class="op">);</span></span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>	printHexByteToASCIIArray<span class="op">(</span>blockSize<span class="op">);</span></span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot; bytes&quot;</span><span class="op">);</span></span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>	<span class="co">// 0xAAAA -&gt; 0xBBBB</span></span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">35</span><span class="op">);</span></span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;from 0x&quot;</span><span class="op">);</span></span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>	printHexWordToASCIIArray<span class="op">(</span>srcAddress<span class="op">);</span></span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot; -&gt; 0x&quot;</span><span class="op">);</span></span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>	printHexWordToASCIIArray<span class="op">(</span>destAddress<span class="op">);</span></span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>	<span class="co">// for each byte in totalBytes, copy from src to dest, then increase pointers</span></span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>	<span class="cf">while</span> <span class="op">(</span>totalBytes <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a>		writeToExternalAddress<span class="op">(</span>destAddress<span class="op">,</span> readFromExternalAddress<span class="op">(</span>srcAddress<span class="op">));</span></span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a>		totalBytes<span class="op">--;</span></span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a>		srcAddress<span class="op">++;</span></span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>		destAddress<span class="op">++;</span></span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a>	errorBackToMenu<span class="op">(</span><span class="st">&quot;Move Complete!&quot;</span><span class="op">);</span></span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb14" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;RTC.h&quot;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;LCD.h&quot;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Utils.h&quot;</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Keypad.h&quot;</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Constants.h&quot;</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">// void rtcInit(void)</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">// {</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">//     uint8_t mon_ctrl = __MON_E32K_SET__ | 0x05;   // Set month to May (05)</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">//     uint8_t ctrl_a =  __CTRLA_PAB_SET__;          // Control A settings (no changes needed here)</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">//     uint8_t ctrl_b = (__CTRLB_TE_SET__ | __CTRLB_BME_SET__); // Control B settings (no changes needed here)</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">//     iowrite8((uint8_t __xdata *)(__RTC_CTRL_A_REG__), ctrl_a); // Set Control A register</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">//     iowrite8((uint8_t __xdata *)(__RTC_CTRL_B_REG__), ctrl_b); // Set Control B register</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co">//     iowrite8((uint8_t __xdata *)(__RTC_MONTH_REG__), mon_ctrl); // Set month to May</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co">//     iowrite8((uint8_t __xdata *)(__RTC_YEAR_REG__), 0x24); // Set year to 24 (2024 in BCD)</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co">//     iowrite8((uint8_t __xdata *)(__RTC_DATE_REG__), 0x09); // Set date to 08 (for May 8th)</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co">//     iowrite8((uint8_t __xdata *)(__RTC_HOURS_REG__), 0x01); // Hours in 24-hour format, 14 for 2 PM</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co">//     iowrite8((uint8_t __xdata *)(__RTC_MINUTES_REG__), 0x00); // Set minutes to 30</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co">//     iowrite8((uint8_t __xdata *)(__RTC_SECONDS_REG__), 0x00); // Set seconds to 00</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co">//     // Additional setup can be done below if needed (e.g., alarms)</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co">// }</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> rtcBcdToAscii<span class="op">(</span><span class="dt">uint8_t</span> bcd<span class="op">)</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>	bcd <span class="op">=</span> bcd <span class="op">&amp;</span> <span class="bn">0x0F</span><span class="op">;</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> <span class="op">(</span>bcd <span class="op">&lt;</span> <span class="dv">10</span><span class="op">)</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>	<span class="op">{</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>		bcd <span class="op">=</span> <span class="bn">0x30</span> <span class="op">+</span> bcd<span class="op">;</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> bcd<span class="op">;</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> rtcAsciiToBcd<span class="op">(</span><span class="dt">uint8_t</span> ascii<span class="op">)</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span><span class="op">(</span>ascii <span class="op">&gt;=</span> <span class="bn">0x30</span> <span class="op">&amp;&amp;</span> ascii <span class="op">&lt;</span> <span class="bn">0x3A</span><span class="op">)</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>	<span class="op">{</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>		ascii <span class="op">=</span> ascii <span class="op">&amp;</span> <span class="bn">0x0F</span><span class="op">;</span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> ascii<span class="op">;</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> rtcRegToLCD<span class="op">(</span><span class="dt">uint8_t</span> __xdata <span class="op">*</span> reg<span class="op">,</span> <span class="dt">uint8_t</span> mask<span class="op">)</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> rtcTemp<span class="op">,</span>rtcCurrent<span class="op">;</span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>	rtcCurrent <span class="op">=</span> ioread8<span class="op">(</span>reg<span class="op">);</span></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>	rtcCurrent <span class="op">=</span> rtcCurrent <span class="op">&amp;</span> mask<span class="op">;</span></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>	rtcTemp <span class="op">=</span> rtcCurrent <span class="op">&gt;&gt;</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span>rtcBcdToAscii<span class="op">(</span>rtcTemp<span class="op">));</span></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span>rtcBcdToAscii<span class="op">(</span>rtcCurrent<span class="op">));</span></span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> rtcPrint<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> __xdata <span class="op">*</span> ptr <span class="op">=</span> <span class="op">(</span><span class="dt">uint8_t</span> __xdata <span class="op">*)(</span>__RTC_MONTH_REG__<span class="op">);</span></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>	rtcRegToLCD<span class="op">(</span>ptr<span class="op">,</span> <span class="bn">0x1F</span><span class="op">);</span></span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span><span class="ch">&#39;/&#39;</span><span class="op">);</span></span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>	ptr <span class="op">=</span> <span class="op">(</span><span class="dt">uint8_t</span> __xdata <span class="op">*)(</span>__RTC_DATE_REG__<span class="op">);</span></span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>	rtcRegToLCD<span class="op">(</span>ptr<span class="op">,</span> <span class="bn">0x3F</span><span class="op">);</span></span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span><span class="ch">&#39;/&#39;</span><span class="op">);</span></span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>	ptr <span class="op">=</span> <span class="op">(</span><span class="dt">uint8_t</span> __xdata <span class="op">*)(</span>__RTC_YEAR_REG__<span class="op">);</span></span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>	rtcRegToLCD<span class="op">(</span>ptr<span class="op">,</span> <span class="bn">0xFF</span><span class="op">);</span></span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span><span class="ch">&#39; &#39;</span><span class="op">);</span></span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a>	ptr <span class="op">=</span> <span class="op">(</span><span class="dt">uint8_t</span> __xdata <span class="op">*)(</span>__RTC_HOURS_REG__<span class="op">);</span></span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>	rtcRegToLCD<span class="op">(</span>ptr<span class="op">,</span> <span class="bn">0x3F</span><span class="op">);</span></span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span><span class="ch">&#39;:&#39;</span><span class="op">);</span></span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a>	ptr <span class="op">=</span> <span class="op">(</span><span class="dt">uint8_t</span> __xdata <span class="op">*)(</span>__RTC_MINUTES_REG__<span class="op">);</span></span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a>	rtcRegToLCD<span class="op">(</span>ptr<span class="op">,</span> <span class="bn">0x7F</span><span class="op">);</span></span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span><span class="ch">&#39;:&#39;</span><span class="op">);</span></span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a>	ptr <span class="op">=</span> <span class="op">(</span><span class="dt">uint8_t</span> __xdata <span class="op">*)(</span>__RTC_SECONDS_REG__<span class="op">);</span></span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a>	rtcRegToLCD<span class="op">(</span>ptr<span class="op">,</span><span class="bn">0x7F</span><span class="op">);</span></span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> rtcMenu<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a>	readKeypad<span class="op">();</span></span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;Current date and time:&quot;</span><span class="op">);</span></span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">7</span><span class="op">,</span> <span class="dv">216</span><span class="op">);</span></span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;&lt;0 Exit (hold)    E Edit&gt;&quot;</span><span class="op">);</span></span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> keypadIndex <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a>	<span class="cf">while</span> <span class="op">(</span>keypadIndex <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a>		setCursor<span class="op">(</span><span class="dv">40</span><span class="op">,</span> <span class="dv">120</span><span class="op">);</span></span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a>		rtcPrint<span class="op">();</span></span>
<span id="cb14-89"><a href="#cb14-89" aria-hidden="true" tabindex="-1"></a>		keypadIndex <span class="op">=</span> readKeypad<span class="op">();</span></span>
<span id="cb14-90"><a href="#cb14-90" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb14-91"><a href="#cb14-91" aria-hidden="true" tabindex="-1"></a>	<span class="co">// they pressed edit</span></span>
<span id="cb14-92"><a href="#cb14-92" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> <span class="op">(</span>keypadIndex <span class="op">==</span> <span class="bn">0xDE</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb14-93"><a href="#cb14-93" aria-hidden="true" tabindex="-1"></a>		setCursor<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb14-94"><a href="#cb14-94" aria-hidden="true" tabindex="-1"></a>		printString<span class="op">(</span><span class="st">&quot;Editing date and time...&quot;</span><span class="op">);</span></span>
<span id="cb14-95"><a href="#cb14-95" aria-hidden="true" tabindex="-1"></a>		setCursor<span class="op">(</span><span class="dv">40</span><span class="op">,</span> <span class="dv">120</span><span class="op">);</span></span>
<span id="cb14-96"><a href="#cb14-96" aria-hidden="true" tabindex="-1"></a>		printString<span class="op">(</span><span class="st">&quot;__/__/__ __:__:__&quot;</span><span class="op">);</span></span>
<span id="cb14-97"><a href="#cb14-97" aria-hidden="true" tabindex="-1"></a>		setCursor<span class="op">(</span><span class="dv">40</span><span class="op">,</span> <span class="dv">120</span><span class="op">);</span></span>
<span id="cb14-98"><a href="#cb14-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-99"><a href="#cb14-99" aria-hidden="true" tabindex="-1"></a>		<span class="co">// month</span></span>
<span id="cb14-100"><a href="#cb14-100" aria-hidden="true" tabindex="-1"></a>		<span class="dt">uint8_t</span> firstCharacter <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb14-101"><a href="#cb14-101" aria-hidden="true" tabindex="-1"></a>		printChar<span class="op">(</span>asciiLookup<span class="op">[</span>firstCharacter<span class="op">]);</span></span>
<span id="cb14-102"><a href="#cb14-102" aria-hidden="true" tabindex="-1"></a>		<span class="dt">uint8_t</span> secondCharacter <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb14-103"><a href="#cb14-103" aria-hidden="true" tabindex="-1"></a>		printChar<span class="op">(</span>asciiLookup<span class="op">[</span>secondCharacter<span class="op">]);</span></span>
<span id="cb14-104"><a href="#cb14-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-105"><a href="#cb14-105" aria-hidden="true" tabindex="-1"></a>		<span class="dt">uint8_t</span> month <span class="op">=</span> <span class="op">(</span>firstCharacter <span class="op">&lt;&lt;</span> <span class="dv">4</span><span class="op">)</span> <span class="op">|</span> secondCharacter<span class="op">;</span></span>
<span id="cb14-106"><a href="#cb14-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-107"><a href="#cb14-107" aria-hidden="true" tabindex="-1"></a>		printString<span class="op">(</span><span class="st">&quot;/&quot;</span><span class="op">);</span></span>
<span id="cb14-108"><a href="#cb14-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-109"><a href="#cb14-109" aria-hidden="true" tabindex="-1"></a>		<span class="co">// day</span></span>
<span id="cb14-110"><a href="#cb14-110" aria-hidden="true" tabindex="-1"></a>		firstCharacter <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb14-111"><a href="#cb14-111" aria-hidden="true" tabindex="-1"></a>		printChar<span class="op">(</span>asciiLookup<span class="op">[</span>firstCharacter<span class="op">]);</span></span>
<span id="cb14-112"><a href="#cb14-112" aria-hidden="true" tabindex="-1"></a>		secondCharacter <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb14-113"><a href="#cb14-113" aria-hidden="true" tabindex="-1"></a>		printChar<span class="op">(</span>asciiLookup<span class="op">[</span>secondCharacter<span class="op">]);</span></span>
<span id="cb14-114"><a href="#cb14-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-115"><a href="#cb14-115" aria-hidden="true" tabindex="-1"></a>		<span class="dt">uint8_t</span> day <span class="op">=</span> <span class="op">(</span>firstCharacter <span class="op">&lt;&lt;</span> <span class="dv">4</span><span class="op">)</span> <span class="op">|</span> secondCharacter<span class="op">;</span></span>
<span id="cb14-116"><a href="#cb14-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-117"><a href="#cb14-117" aria-hidden="true" tabindex="-1"></a>		printString<span class="op">(</span><span class="st">&quot;/&quot;</span><span class="op">);</span></span>
<span id="cb14-118"><a href="#cb14-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-119"><a href="#cb14-119" aria-hidden="true" tabindex="-1"></a>		<span class="co">// year</span></span>
<span id="cb14-120"><a href="#cb14-120" aria-hidden="true" tabindex="-1"></a>		firstCharacter <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb14-121"><a href="#cb14-121" aria-hidden="true" tabindex="-1"></a>		printChar<span class="op">(</span>asciiLookup<span class="op">[</span>firstCharacter<span class="op">]);</span></span>
<span id="cb14-122"><a href="#cb14-122" aria-hidden="true" tabindex="-1"></a>		secondCharacter <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb14-123"><a href="#cb14-123" aria-hidden="true" tabindex="-1"></a>		printChar<span class="op">(</span>asciiLookup<span class="op">[</span>secondCharacter<span class="op">]);</span></span>
<span id="cb14-124"><a href="#cb14-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-125"><a href="#cb14-125" aria-hidden="true" tabindex="-1"></a>		<span class="dt">uint8_t</span> year <span class="op">=</span> <span class="op">(</span>firstCharacter <span class="op">&lt;&lt;</span> <span class="dv">4</span><span class="op">)</span> <span class="op">|</span> secondCharacter<span class="op">;</span></span>
<span id="cb14-126"><a href="#cb14-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-127"><a href="#cb14-127" aria-hidden="true" tabindex="-1"></a>		printString<span class="op">(</span><span class="st">&quot; &quot;</span><span class="op">);</span></span>
<span id="cb14-128"><a href="#cb14-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-129"><a href="#cb14-129" aria-hidden="true" tabindex="-1"></a>		<span class="co">// hours</span></span>
<span id="cb14-130"><a href="#cb14-130" aria-hidden="true" tabindex="-1"></a>		firstCharacter <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb14-131"><a href="#cb14-131" aria-hidden="true" tabindex="-1"></a>		printChar<span class="op">(</span>asciiLookup<span class="op">[</span>firstCharacter<span class="op">]);</span></span>
<span id="cb14-132"><a href="#cb14-132" aria-hidden="true" tabindex="-1"></a>		secondCharacter <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb14-133"><a href="#cb14-133" aria-hidden="true" tabindex="-1"></a>		printChar<span class="op">(</span>asciiLookup<span class="op">[</span>secondCharacter<span class="op">]);</span></span>
<span id="cb14-134"><a href="#cb14-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-135"><a href="#cb14-135" aria-hidden="true" tabindex="-1"></a>		<span class="dt">uint8_t</span> hours <span class="op">=</span> <span class="op">(</span>firstCharacter <span class="op">&lt;&lt;</span> <span class="dv">4</span><span class="op">)</span> <span class="op">|</span> secondCharacter<span class="op">;</span></span>
<span id="cb14-136"><a href="#cb14-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-137"><a href="#cb14-137" aria-hidden="true" tabindex="-1"></a>		printString<span class="op">(</span><span class="st">&quot;:&quot;</span><span class="op">);</span></span>
<span id="cb14-138"><a href="#cb14-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-139"><a href="#cb14-139" aria-hidden="true" tabindex="-1"></a>		<span class="co">// minutes</span></span>
<span id="cb14-140"><a href="#cb14-140" aria-hidden="true" tabindex="-1"></a>		firstCharacter <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb14-141"><a href="#cb14-141" aria-hidden="true" tabindex="-1"></a>		printChar<span class="op">(</span>asciiLookup<span class="op">[</span>firstCharacter<span class="op">]);</span></span>
<span id="cb14-142"><a href="#cb14-142" aria-hidden="true" tabindex="-1"></a>		secondCharacter <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb14-143"><a href="#cb14-143" aria-hidden="true" tabindex="-1"></a>		printChar<span class="op">(</span>asciiLookup<span class="op">[</span>secondCharacter<span class="op">]);</span></span>
<span id="cb14-144"><a href="#cb14-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-145"><a href="#cb14-145" aria-hidden="true" tabindex="-1"></a>		<span class="dt">uint8_t</span> minutes <span class="op">=</span> <span class="op">(</span>firstCharacter <span class="op">&lt;&lt;</span> <span class="dv">4</span><span class="op">)</span> <span class="op">|</span> secondCharacter<span class="op">;</span></span>
<span id="cb14-146"><a href="#cb14-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-147"><a href="#cb14-147" aria-hidden="true" tabindex="-1"></a>		printString<span class="op">(</span><span class="st">&quot;:&quot;</span><span class="op">);</span></span>
<span id="cb14-148"><a href="#cb14-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-149"><a href="#cb14-149" aria-hidden="true" tabindex="-1"></a>		<span class="co">// seconds</span></span>
<span id="cb14-150"><a href="#cb14-150" aria-hidden="true" tabindex="-1"></a>		firstCharacter <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb14-151"><a href="#cb14-151" aria-hidden="true" tabindex="-1"></a>		printChar<span class="op">(</span>asciiLookup<span class="op">[</span>firstCharacter<span class="op">]);</span></span>
<span id="cb14-152"><a href="#cb14-152" aria-hidden="true" tabindex="-1"></a>		secondCharacter <span class="op">=</span> waitForKeypad<span class="op">();</span></span>
<span id="cb14-153"><a href="#cb14-153" aria-hidden="true" tabindex="-1"></a>		printChar<span class="op">(</span>asciiLookup<span class="op">[</span>secondCharacter<span class="op">]);</span></span>
<span id="cb14-154"><a href="#cb14-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-155"><a href="#cb14-155" aria-hidden="true" tabindex="-1"></a>		<span class="dt">uint8_t</span> seconds <span class="op">=</span> <span class="op">(</span>firstCharacter <span class="op">&lt;&lt;</span> <span class="dv">4</span><span class="op">)</span> <span class="op">|</span> secondCharacter<span class="op">;</span></span>
<span id="cb14-156"><a href="#cb14-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-157"><a href="#cb14-157" aria-hidden="true" tabindex="-1"></a>		<span class="dt">uint8_t</span> mon_ctrl <span class="op">=</span> __MON_E32K_SET__ <span class="op">|</span> month<span class="op">;</span>   <span class="co">// Set month to May (05)</span></span>
<span id="cb14-158"><a href="#cb14-158" aria-hidden="true" tabindex="-1"></a>	    <span class="dt">uint8_t</span> ctrl_a <span class="op">=</span>  __CTRLA_PAB_SET__<span class="op">;</span>          <span class="co">// Control A settings (no changes needed here)</span></span>
<span id="cb14-159"><a href="#cb14-159" aria-hidden="true" tabindex="-1"></a>	    <span class="dt">uint8_t</span> ctrl_b <span class="op">=</span> <span class="op">(</span>__CTRLB_TE_SET__ <span class="op">|</span> __CTRLB_BME_SET__<span class="op">);</span> <span class="co">// Control B settings (no changes needed here)</span></span>
<span id="cb14-160"><a href="#cb14-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-161"><a href="#cb14-161" aria-hidden="true" tabindex="-1"></a>	    iowrite8<span class="op">((</span><span class="dt">uint8_t</span> __xdata <span class="op">*)(</span>__RTC_CTRL_A_REG__<span class="op">),</span> ctrl_a<span class="op">);</span> <span class="co">// Set Control A register</span></span>
<span id="cb14-162"><a href="#cb14-162" aria-hidden="true" tabindex="-1"></a>	    iowrite8<span class="op">((</span><span class="dt">uint8_t</span> __xdata <span class="op">*)(</span>__RTC_CTRL_B_REG__<span class="op">),</span> ctrl_b<span class="op">);</span> <span class="co">// Set Control B register</span></span>
<span id="cb14-163"><a href="#cb14-163" aria-hidden="true" tabindex="-1"></a>	    iowrite8<span class="op">((</span><span class="dt">uint8_t</span> __xdata <span class="op">*)(</span>__RTC_MONTH_REG__<span class="op">),</span> mon_ctrl<span class="op">);</span> <span class="co">// Set month to May</span></span>
<span id="cb14-164"><a href="#cb14-164" aria-hidden="true" tabindex="-1"></a>	    iowrite8<span class="op">((</span><span class="dt">uint8_t</span> __xdata <span class="op">*)(</span>__RTC_YEAR_REG__<span class="op">),</span> year<span class="op">);</span> <span class="co">// Set year to 24 (2024 in BCD)</span></span>
<span id="cb14-165"><a href="#cb14-165" aria-hidden="true" tabindex="-1"></a>	    iowrite8<span class="op">((</span><span class="dt">uint8_t</span> __xdata <span class="op">*)(</span>__RTC_DATE_REG__<span class="op">),</span> day<span class="op">);</span> <span class="co">// Set date to 08 (for May 8th)</span></span>
<span id="cb14-166"><a href="#cb14-166" aria-hidden="true" tabindex="-1"></a>	    iowrite8<span class="op">((</span><span class="dt">uint8_t</span> __xdata <span class="op">*)(</span>__RTC_HOURS_REG__<span class="op">),</span> hours<span class="op">);</span> <span class="co">// Hours in 24-hour format, 14 for 2 PM</span></span>
<span id="cb14-167"><a href="#cb14-167" aria-hidden="true" tabindex="-1"></a>	    iowrite8<span class="op">((</span><span class="dt">uint8_t</span> __xdata <span class="op">*)(</span>__RTC_MINUTES_REG__<span class="op">),</span> minutes<span class="op">);</span> <span class="co">// Set minutes to 30</span></span>
<span id="cb14-168"><a href="#cb14-168" aria-hidden="true" tabindex="-1"></a>	    iowrite8<span class="op">((</span><span class="dt">uint8_t</span> __xdata <span class="op">*)(</span>__RTC_SECONDS_REG__<span class="op">),</span> seconds<span class="op">);</span> <span class="co">// Set seconds to 00</span></span>
<span id="cb14-169"><a href="#cb14-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-170"><a href="#cb14-170" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb14-171"><a href="#cb14-171" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb15" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">// associated header file</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;RamCheck.h&quot;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">// including standard headers and portable datatypes</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;8051.h&quot;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Bool.h&quot;</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;LCD.h&quot;</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Utils.h&quot;</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Keypad.h&quot;</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> writeAllRam<span class="op">(</span><span class="dt">uint8_t</span> value<span class="op">)</span> <span class="op">{</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>	<span class="co">// the assembly code will fetch the value to be written from the bccumulator</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>	B <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>	__asm</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>		RAMCHECK_WRITE_LOOP <span class="op">.</span>EQU <span class="dv">1</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>		MOV DPH<span class="op">,</span> #<span class="dv">0</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>		MOV DPL<span class="op">,</span> #<span class="dv">0</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>		RAMCHECK_WRITE_LOOP$<span class="op">:</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>			MOV A<span class="op">,</span> B</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>			MOVX @DPTR<span class="op">,</span> A</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>			INC DPTR</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>			MOV A<span class="op">,</span> DPL</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>			ORL A<span class="op">,</span> DPH</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>			JNZ RAMCHECK_WRITE_LOOP$</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>	__endasm<span class="op">;</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> readAllRam<span class="op">(</span><span class="dt">uint8_t</span> value<span class="op">)</span> <span class="op">{</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>	<span class="co">// the assembly code will fetch the value to be compared against from the bccumulator</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>	B <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>	__asm</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>		RAMCHECK_READ_LOOP <span class="op">.</span>EQU <span class="dv">1</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>		RAMCHECK_READ_FAIL <span class="op">.</span>EQU <span class="dv">2</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>		RAMCHECK_READ_DONE <span class="op">.</span>EQU <span class="dv">3</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>		MOV DPH<span class="op">,</span> #<span class="dv">0</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>		MOV DPL<span class="op">,</span> #<span class="dv">0</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>		RAMCHECK_READ_LOOP$<span class="op">:</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>			MOVX A<span class="op">,</span> @DPTR</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>			SUBB A<span class="op">,</span> B</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>			JNZ RAMCHECK_READ_FAIL$</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>			INC DPTR</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>			MOV A<span class="op">,</span> DPL</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>			ORL A<span class="op">,</span> DPH</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>			JNZ RAMCHECK_READ_LOOP$</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>			MOV B<span class="op">,</span> #<span class="dv">1</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>			SJMP RAMCHECK_READ_DONE$</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>		RAMCHECK_READ_FAIL$<span class="op">:</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>			MOV B<span class="op">,</span> #<span class="dv">0</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>		RAMCHECK_READ_DONE$<span class="op">:</span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>	__endasm<span class="op">;</span></span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>	<span class="co">// returns the value our assembly put in regB as a true/false</span></span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> B<span class="op">;</span></span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a><span class="co">// takes a byte value, writes it to the entire XRAM, then inverts and repeats</span></span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a><span class="co">// returns FALSE on success, TRUE on error</span></span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> ramCheckCycle<span class="op">(</span><span class="dt">uint8_t</span> value<span class="op">)</span> <span class="op">{</span></span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>	<span class="co">// Writing RAM w/ value: 0x__</span></span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;Writing 0x&quot;</span><span class="op">);</span></span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>	printHexByteToASCIIArray<span class="op">(</span>value<span class="op">);</span></span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;... &quot;</span><span class="op">);</span></span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>	<span class="co">// perform the write</span></span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>	writeAllRam<span class="op">(</span>value<span class="op">);</span></span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;done&quot;</span><span class="op">);</span></span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>	<span class="co">// Checking RAM w/</span></span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>	<span class="co">// leaving &quot;value: 0x__&quot; on screen</span></span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">10</span><span class="op">,</span> getCursorY<span class="op">()</span> <span class="op">+</span> <span class="dv">25</span><span class="op">);</span></span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;Checking for 0x&quot;</span><span class="op">);</span></span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a>	printHexByteToASCIIArray<span class="op">(</span>value<span class="op">);</span></span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;... &quot;</span><span class="op">);</span></span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a>	<span class="co">// perform the read</span></span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a>	<span class="dt">bool</span> readSuccess <span class="op">=</span> readAllRam<span class="op">(</span>value<span class="op">);</span></span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a>	<span class="co">// if we failed the read, tell the user and duck out immediately</span></span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> <span class="op">(!</span>readSuccess<span class="op">)</span> <span class="op">{</span></span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a>		errorBackToMenu<span class="op">(</span><span class="st">&quot;RAM Fail!&quot;</span><span class="op">);</span></span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a>		<span class="co">// </span><span class="al">TODO</span><span class="co">: return address of failure?</span></span>
<span id="cb15-83"><a href="#cb15-83" aria-hidden="true" tabindex="-1"></a>		<span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb15-84"><a href="#cb15-84" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb15-85"><a href="#cb15-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-86"><a href="#cb15-86" aria-hidden="true" tabindex="-1"></a>	<span class="co">// we succeeded!</span></span>
<span id="cb15-87"><a href="#cb15-87" aria-hidden="true" tabindex="-1"></a>	printString<span class="op">(</span><span class="st">&quot;done&quot;</span><span class="op">);</span></span>
<span id="cb15-88"><a href="#cb15-88" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">10</span><span class="op">,</span> getCursorY<span class="op">()</span> <span class="op">+</span> <span class="dv">25</span><span class="op">);</span></span>
<span id="cb15-89"><a href="#cb15-89" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb15-90"><a href="#cb15-90" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb15-91"><a href="#cb15-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-92"><a href="#cb15-92" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> ramCheck<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb15-93"><a href="#cb15-93" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> value <span class="op">=</span> promptForByte<span class="op">(</span><span class="st">&quot;RAM Check Value?&quot;</span><span class="op">);</span></span>
<span id="cb15-94"><a href="#cb15-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-95"><a href="#cb15-95" aria-hidden="true" tabindex="-1"></a>	clearLCD<span class="op">();</span></span>
<span id="cb15-96"><a href="#cb15-96" aria-hidden="true" tabindex="-1"></a>	setCursor<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb15-97"><a href="#cb15-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-98"><a href="#cb15-98" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> <span class="op">(</span>ramCheckCycle<span class="op">(</span>value<span class="op">)</span> <span class="op">!=</span> <span class="dv">0</span> <span class="op">||</span> ramCheckCycle<span class="op">(~</span>value<span class="op">)</span> <span class="op">!=</span> <span class="dv">0</span><span class="op">)</span></span>
<span id="cb15-99"><a href="#cb15-99" aria-hidden="true" tabindex="-1"></a>		<span class="co">// error, return immediately to menu</span></span>
<span id="cb15-100"><a href="#cb15-100" aria-hidden="true" tabindex="-1"></a>		<span class="cf">return</span><span class="op">;</span></span>
<span id="cb15-101"><a href="#cb15-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-102"><a href="#cb15-102" aria-hidden="true" tabindex="-1"></a>	errorBackToMenu<span class="op">(</span><span class="st">&quot;RAM Success!&quot;</span><span class="op">);</span></span>
<span id="cb15-103"><a href="#cb15-103" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span><span class="op">;</span></span>
<span id="cb15-104"><a href="#cb15-104" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb16" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Segment.h&quot;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;8051.h&quot;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;LCD.h&quot;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Constants.h&quot;</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Utils.h&quot;</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> hexToSegment<span class="op">(</span><span class="dt">uint8_t</span> byte<span class="op">)</span> <span class="op">{</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> segment <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>	segment <span class="op">=</span> segconvert<span class="op">[</span>byte<span class="op">];</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>	iowrite8<span class="op">((</span><span class="dt">char</span> __xdata<span class="op">*)(</span><span class="bn">0x8000</span><span class="op">),</span> segment<span class="op">);</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> loadingLoop<span class="op">(</span><span class="dt">uint8_t</span> count<span class="op">)</span> <span class="op">{</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>	<span class="cf">for</span> <span class="op">(</span><span class="dt">uint8_t</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> count<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>		iowrite8<span class="op">((</span><span class="dt">char</span> __xdata<span class="op">*)(</span><span class="bn">0x8000</span><span class="op">),</span> <span class="bn">0x01</span><span class="op">);</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>		delay<span class="op">(</span><span class="dv">100</span><span class="op">);</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>		iowrite8<span class="op">((</span><span class="dt">char</span> __xdata<span class="op">*)(</span><span class="bn">0x8000</span><span class="op">),</span> <span class="bn">0x02</span><span class="op">);</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>		delay<span class="op">(</span><span class="dv">100</span><span class="op">);</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>		iowrite8<span class="op">((</span><span class="dt">char</span> __xdata<span class="op">*)(</span><span class="bn">0x8000</span><span class="op">),</span> <span class="bn">0x04</span><span class="op">);</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>		delay<span class="op">(</span><span class="dv">100</span><span class="op">);</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>		iowrite8<span class="op">((</span><span class="dt">char</span> __xdata<span class="op">*)(</span><span class="bn">0x8000</span><span class="op">),</span> <span class="bn">0x08</span><span class="op">);</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>		delay<span class="op">(</span><span class="dv">100</span><span class="op">);</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>		iowrite8<span class="op">((</span><span class="dt">char</span> __xdata<span class="op">*)(</span><span class="bn">0x8000</span><span class="op">),</span> <span class="bn">0x10</span><span class="op">);</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>		delay<span class="op">(</span><span class="dv">100</span><span class="op">);</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>		iowrite8<span class="op">((</span><span class="dt">char</span> __xdata<span class="op">*)(</span><span class="bn">0x8000</span><span class="op">),</span> <span class="bn">0x20</span><span class="op">);</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>		delay<span class="op">(</span><span class="dv">100</span><span class="op">);</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>	iowrite8<span class="op">((</span><span class="dt">char</span> __xdata<span class="op">*)(</span><span class="bn">0x8000</span><span class="op">),</span> <span class="bn">0x00</span><span class="op">);</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb17" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Serial.h&quot;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;8051.h&quot;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> serialInit<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>	P3 <span class="op">|=</span> <span class="op">(</span><span class="dv">1</span><span class="op">&lt;&lt;</span><span class="dv">0</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="dv">1</span><span class="op">&lt;&lt;</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>	TL1 <span class="op">=</span> <span class="bn">0xF3</span><span class="op">;</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>	TH1 <span class="op">=</span> <span class="bn">0xF3</span><span class="op">;</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>	TMOD <span class="op">=</span> <span class="bn">0x20</span><span class="op">;</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>	PCON <span class="op">|=</span> <span class="op">(</span><span class="dv">1</span><span class="op">&lt;&lt;</span><span class="dv">7</span><span class="op">);</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>	SCON <span class="op">|=</span> <span class="op">(</span><span class="dv">1</span><span class="op">&lt;&lt;</span><span class="dv">6</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="dv">1</span><span class="op">&lt;&lt;</span><span class="dv">4</span><span class="op">);</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>	IE <span class="op">|=</span> <span class="op">(</span><span class="dv">1</span><span class="op">&lt;&lt;</span><span class="dv">7</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="dv">1</span><span class="op">&lt;&lt;</span><span class="dv">4</span><span class="op">);</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>	TCON <span class="op">=</span> <span class="bn">0x40</span><span class="op">;</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb18" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">// associated header file</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Utils.h&quot;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">// including standard headers and portable datatypes</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;8051.h&quot;</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Constants.h&quot;</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;LCD.h&quot;</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> printHexByteToASCIIArray<span class="op">(</span><span class="dt">uint8_t</span> byte<span class="op">)</span> <span class="op">{</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span>asciiLookup<span class="op">[((</span>byte <span class="op">&gt;&gt;</span> <span class="dv">4</span><span class="op">)</span> <span class="op">&amp;</span> <span class="bn">0x0F</span><span class="op">)]);</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span>asciiLookup<span class="op">[(</span>byte <span class="op">&amp;</span> <span class="bn">0x0F</span><span class="op">)]);</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> printHexWordToASCIIArray<span class="op">(</span><span class="dt">uint16_t</span> word<span class="op">)</span> <span class="op">{</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span>asciiLookup<span class="op">[((</span>word <span class="op">&gt;&gt;</span> <span class="dv">12</span><span class="op">)</span> <span class="op">&amp;</span> <span class="bn">0x0F</span><span class="op">)]);</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span>asciiLookup<span class="op">[((</span>word <span class="op">&gt;&gt;</span> <span class="dv">8</span><span class="op">)</span> <span class="op">&amp;</span> <span class="bn">0x0F</span><span class="op">)]);</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span>asciiLookup<span class="op">[((</span>word <span class="op">&gt;&gt;</span> <span class="dv">4</span><span class="op">)</span> <span class="op">&amp;</span> <span class="bn">0x0F</span><span class="op">)]);</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>	printChar<span class="op">(</span>asciiLookup<span class="op">[(</span>word <span class="op">&amp;</span> <span class="bn">0x0F</span><span class="op">)]);</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> iowrite8<span class="op">(</span><span class="dt">uint8_t</span> __xdata<span class="op">*</span> map_address<span class="op">,</span> <span class="dt">uint8_t</span> d<span class="op">)</span> <span class="op">{</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>	IOM <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>	<span class="op">*</span>map_address <span class="op">=</span> d<span class="op">;</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>	IOM <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">uint8_t</span> ioread8<span class="op">(</span><span class="dt">uint8_t</span> __xdata<span class="op">*</span> map_address<span class="op">)</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>	<span class="dt">uint8_t</span> d<span class="op">;</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>	IOM <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>	d <span class="op">=</span> <span class="op">*</span>map_address<span class="op">;</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>	IOM <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> d<span class="op">;</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb19" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#ifndef ADC_H</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ADC_H</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> adcMenu<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> adcPrint<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span></code></pre></div>
<div class="sourceCode" id="cb20" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#ifndef CONSTANTS_H</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define CONSTANTS_H</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="kw">extern</span> __code <span class="dt">char</span> asciiLookup<span class="op">[</span><span class="dv">17</span><span class="op">];</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="kw">extern</span> __code <span class="dt">char</span> menuCount<span class="op">;</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="kw">extern</span> __code <span class="dt">char</span><span class="op">*</span> menuOptions<span class="op">[</span><span class="dv">8</span><span class="op">];</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="kw">extern</span> __code <span class="dt">char</span> blockSizeMenuCount<span class="op">;</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="kw">extern</span> __code <span class="dt">char</span><span class="op">*</span> blockSizeMenuOptions<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="kw">extern</span> __code <span class="dt">char</span> blockSizeMenuButtons<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="kw">extern</span> __code <span class="dt">char</span> segconvert<span class="op">[</span><span class="dv">16</span><span class="op">];</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span></code></pre></div>
<div class="sourceCode" id="cb21" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#ifndef COUNT_H</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define COUNT_H</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> count<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span></code></pre></div>
<div class="sourceCode" id="cb22" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#ifndef DUMP_H</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define DUMP_H</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;8051.h&quot;</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Bool.h&quot;</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> dumpPage<span class="op">(</span><span class="dt">uint16_t</span> address<span class="op">,</span> <span class="dt">uint8_t</span> byteCount<span class="op">,</span> <span class="dt">bool</span> pagesBefore<span class="op">,</span> <span class="dt">bool</span> pagesAfter<span class="op">);</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dump<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span></code></pre></div>
<div class="sourceCode" id="cb23" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#ifndef EDIT_H</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define EDIT_H</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> editPage<span class="op">(</span><span class="dt">uint16_t</span> address<span class="op">);</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> edit<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span></code></pre></div>
<div class="sourceCode" id="cb24" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#ifndef FIND_H</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define FIND_H</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Bool.h&quot;</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> findPage<span class="op">(</span><span class="dt">uint16_t</span> address<span class="op">,</span> <span class="dt">bool</span> pagesBefore<span class="op">,</span> <span class="dt">bool</span> pagesAfter<span class="op">);</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> findArgs<span class="op">(</span><span class="dt">uint16_t</span> startAddress<span class="op">,</span> <span class="dt">uint16_t</span> blockQuantity<span class="op">,</span> <span class="dt">uint8_t</span> searchValue<span class="op">);</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> find<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span></code></pre></div>
<div class="sourceCode" id="cb25" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#ifndef KEYPAD_H</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define KEYPAD_H</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;8051.h&quot;</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> checkRows<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> checkColumns<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> readKeypad<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> decodeKeypadToHex<span class="op">(</span><span class="dt">uint8_t</span> keypadIndex<span class="op">);</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> waitForKeypad<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> waitForKey<span class="op">(</span><span class="dt">uint8_t</span> key<span class="op">);</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> promptForByte<span class="op">(</span><span class="dt">char</span><span class="op">*</span> prompt<span class="op">);</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="dt">uint16_t</span> promptForWord<span class="op">(</span><span class="dt">char</span><span class="op">*</span> prompt<span class="op">);</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> setSerialData<span class="op">(</span><span class="dt">uint8_t</span> data<span class="op">);</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> getSerialData<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span></code></pre></div>
<div class="sourceCode" id="cb26" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* all the required header for project here*/</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#ifndef LCD_H</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#define LCD_H</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;8051.h&gt;</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co">/* define any address for lcd for address decoding */</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="pp">#define LCD_ADDRESS </span><span class="bn">0x4000</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co">/* LCD specific variables */</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="pp">#define TFTWIDTH </span><span class="dv">240</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="pp">#define TFTHEIGHT </span><span class="dv">320</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="co">/* A good way to stay consistent with writing signals */</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ACTIVE	</span><span class="dv">0</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="pp">#define IDLE 	</span><span class="dv">1</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="pp">#define CMD 	</span><span class="dv">0</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="pp">#define DATA 	</span><span class="dv">1</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="pp">#define IO 	</span><span class="dv">1</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MEM 	</span><span class="dv">0</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a><span class="co">/* LCD control pin interfacing. */</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a><span class="pp">#define IOM P3_4</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a><span class="pp">#define CD P3_5</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a><span class="co">/* definition of colors in 2-bytes*/</span></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a><span class="pp">#define BLACK </span><span class="bn">0x0000</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a><span class="pp">#define GRAY </span><span class="bn">0xD6BA</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a><span class="pp">#define BLUE </span><span class="bn">0x001F</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a><span class="pp">#define RED </span><span class="bn">0xF800</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a><span class="pp">#define LIME </span><span class="bn">0x07E0</span></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a><span class="pp">#define GREEN </span><span class="bn">0x0401</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a><span class="pp">#define CYAN </span><span class="bn">0x07FF</span></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MAGENTA </span><span class="bn">0xF81F</span></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a><span class="pp">#define YELLOW </span><span class="bn">0xFFE0</span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a><span class="pp">#define WHITE </span><span class="bn">0xFFFF</span></span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a><span class="co">/*ILI9341 Registers*/</span></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_SOFTRESET          </span><span class="bn">0x01</span></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_SLEEPIN            </span><span class="bn">0x10</span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_SLEEPOUT           </span><span class="bn">0x11</span></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_NORMALDISP         </span><span class="bn">0x13</span></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_INVERTOFF          </span><span class="bn">0x20</span></span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_INVERTON           </span><span class="bn">0x21</span></span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_GAMMASET           </span><span class="bn">0x26</span></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_DISPLAYOFF         </span><span class="bn">0x28</span></span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_DISPLAYON          </span><span class="bn">0x29</span></span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_COLADDRSET         </span><span class="bn">0x2A</span></span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_PAGEADDRSET        </span><span class="bn">0x2B</span></span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_MEMORYWRITE        </span><span class="bn">0x2C</span></span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_PIXELFORMAT        </span><span class="bn">0x3A</span></span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_FRAMECONTROL       </span><span class="bn">0xB1</span></span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_DISPLAYFUNC        </span><span class="bn">0xB6</span></span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_ENTRYMODE          </span><span class="bn">0xB7</span></span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_POWERCONTROL1      </span><span class="bn">0xC0</span></span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_POWERCONTROL2      </span><span class="bn">0xC1</span></span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_VCOMCONTROL1       </span><span class="bn">0xC5</span></span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_VCOMCONTROL2       </span><span class="bn">0xC7</span></span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_MEMCONTROL         </span><span class="bn">0x36</span></span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_MADCTL  	   </span><span class="bn">0x36</span></span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_MADCTL_MY  	   </span><span class="bn">0x80</span></span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_MADCTL_MX  	   </span><span class="bn">0x40</span></span>
<span id="cb26-71"><a href="#cb26-71" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_MADCTL_MV  	   </span><span class="bn">0x20</span></span>
<span id="cb26-72"><a href="#cb26-72" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_MADCTL_ML  	   </span><span class="bn">0x10</span></span>
<span id="cb26-73"><a href="#cb26-73" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_MADCTL_RGB 	   </span><span class="bn">0x00</span></span>
<span id="cb26-74"><a href="#cb26-74" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_MADCTL_BGR 	   </span><span class="bn">0x08</span></span>
<span id="cb26-75"><a href="#cb26-75" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ILI9341_MADCTL_MH  	   </span><span class="bn">0x04</span></span>
<span id="cb26-76"><a href="#cb26-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-77"><a href="#cb26-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-78"><a href="#cb26-78" aria-hidden="true" tabindex="-1"></a><span class="co">//Prototypes!</span></span>
<span id="cb26-79"><a href="#cb26-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-80"><a href="#cb26-80" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> delay <span class="op">(</span><span class="dt">int16_t</span> d<span class="op">);</span></span>
<span id="cb26-81"><a href="#cb26-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-82"><a href="#cb26-82" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> lcdWrite8Reg<span class="op">(</span><span class="dt">uint8_t</span> d<span class="op">);</span></span>
<span id="cb26-83"><a href="#cb26-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-84"><a href="#cb26-84" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> lcdWrite8Data<span class="op">(</span><span class="dt">uint8_t</span> d<span class="op">);</span></span>
<span id="cb26-85"><a href="#cb26-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-86"><a href="#cb26-86" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> lcdWrite8DataBlocking<span class="op">(</span><span class="dt">uint8_t</span> d<span class="op">);</span></span>
<span id="cb26-87"><a href="#cb26-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-88"><a href="#cb26-88" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> lcdWriteRegData8<span class="op">(</span><span class="dt">uint8_t</span> a<span class="op">,</span> <span class="dt">uint8_t</span> d<span class="op">);</span></span>
<span id="cb26-89"><a href="#cb26-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-90"><a href="#cb26-90" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> setCursorx<span class="op">(</span><span class="dt">uint16_t</span> x<span class="op">);</span></span>
<span id="cb26-91"><a href="#cb26-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-92"><a href="#cb26-92" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> setCursory<span class="op">(</span><span class="dt">uint16_t</span> y<span class="op">);</span></span>
<span id="cb26-93"><a href="#cb26-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-94"><a href="#cb26-94" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> lcdWriteRegData16<span class="op">(</span><span class="dt">uint16_t</span> a<span class="op">,</span> <span class="dt">uint16_t</span> d<span class="op">);</span></span>
<span id="cb26-95"><a href="#cb26-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-96"><a href="#cb26-96" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> setCursor<span class="op">(</span><span class="dt">uint16_t</span> x<span class="op">,</span> <span class="dt">uint16_t</span> y<span class="op">);</span></span>
<span id="cb26-97"><a href="#cb26-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-98"><a href="#cb26-98" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> setTextColor<span class="op">(</span><span class="dt">uint16_t</span> x<span class="op">,</span> <span class="dt">uint16_t</span> y<span class="op">);</span></span>
<span id="cb26-99"><a href="#cb26-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-100"><a href="#cb26-100" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> setTextSize<span class="op">(</span><span class="dt">uint8_t</span> s<span class="op">);</span></span>
<span id="cb26-101"><a href="#cb26-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-102"><a href="#cb26-102" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> setRotation<span class="op">(</span><span class="dt">uint8_t</span> flag<span class="op">);</span></span>
<span id="cb26-103"><a href="#cb26-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-104"><a href="#cb26-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-105"><a href="#cb26-105" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> setAddress<span class="op">(</span><span class="dt">uint16_t</span> x1<span class="op">,</span><span class="dt">uint16_t</span> y1<span class="op">,</span><span class="dt">uint16_t</span> x2<span class="op">,</span><span class="dt">uint16_t</span> y2<span class="op">);</span></span>
<span id="cb26-106"><a href="#cb26-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-107"><a href="#cb26-107" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> initLCD<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb26-108"><a href="#cb26-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-109"><a href="#cb26-109" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> drawPixel<span class="op">(</span><span class="dt">uint16_t</span> x3<span class="op">,</span><span class="dt">uint16_t</span> y3<span class="op">,</span><span class="dt">uint16_t</span> color1<span class="op">);</span></span>
<span id="cb26-110"><a href="#cb26-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-111"><a href="#cb26-111" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> drawCircle<span class="op">(</span><span class="dt">int16_t</span> x0<span class="op">,</span> <span class="dt">int16_t</span> y0<span class="op">,</span> <span class="dt">int16_t</span> r<span class="op">,</span> <span class="dt">uint16_t</span> color<span class="op">);</span></span>
<span id="cb26-112"><a href="#cb26-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-113"><a href="#cb26-113" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> fillRect<span class="op">(</span><span class="dt">uint16_t</span> x<span class="op">,</span><span class="dt">uint16_t</span> y<span class="op">,</span><span class="dt">uint16_t</span> w<span class="op">,</span><span class="dt">uint16_t</span> h<span class="op">,</span><span class="dt">uint16_t</span> color<span class="op">);</span></span>
<span id="cb26-114"><a href="#cb26-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-115"><a href="#cb26-115" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> fillScreen<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb26-116"><a href="#cb26-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-117"><a href="#cb26-117" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> drawChar<span class="op">(</span><span class="dt">uint8_t</span> c<span class="op">);</span></span>
<span id="cb26-118"><a href="#cb26-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-119"><a href="#cb26-119" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> printChar<span class="op">(</span><span class="dt">uint8_t</span> c<span class="op">);</span></span>
<span id="cb26-120"><a href="#cb26-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-121"><a href="#cb26-121" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> printString<span class="op">(</span><span class="dt">char</span> <span class="op">*</span>str<span class="op">);</span></span>
<span id="cb26-122"><a href="#cb26-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-123"><a href="#cb26-123" aria-hidden="true" tabindex="-1"></a><span class="dt">uint16_t</span> reverse<span class="op">(</span><span class="dt">uint8_t</span> d<span class="op">);</span></span>
<span id="cb26-124"><a href="#cb26-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-125"><a href="#cb26-125" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> asciiToDec<span class="op">(</span><span class="dt">uint8_t</span> d<span class="op">);</span></span>
<span id="cb26-126"><a href="#cb26-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-127"><a href="#cb26-127" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> asciiToHex<span class="op">(</span><span class="dt">uint8_t</span> d<span class="op">);</span></span>
<span id="cb26-128"><a href="#cb26-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-129"><a href="#cb26-129" aria-hidden="true" tabindex="-1"></a><span class="dt">uint16_t</span> getCursorX<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb26-130"><a href="#cb26-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-131"><a href="#cb26-131" aria-hidden="true" tabindex="-1"></a><span class="dt">uint16_t</span> getCursorY<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb26-132"><a href="#cb26-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-133"><a href="#cb26-133" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> getTextSize<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb26-134"><a href="#cb26-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-135"><a href="#cb26-135" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> clearLCD<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb26-136"><a href="#cb26-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-137"><a href="#cb26-137" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> errorBackToMenu<span class="op">(</span><span class="dt">char</span><span class="op">*</span> message<span class="op">);</span></span>
<span id="cb26-138"><a href="#cb26-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-139"><a href="#cb26-139" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span></code></pre></div>
<div class="sourceCode" id="cb27" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#ifndef MEMORY_H</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MEMORY_H</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;8051.h&quot;</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Bool.h&quot;</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> readFromExternalAddress<span class="op">(</span><span class="dt">uint16_t</span> address<span class="op">);</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> writeToExternalAddress<span class="op">(</span><span class="dt">uint16_t</span> address<span class="op">,</span> <span class="dt">uint8_t</span> value<span class="op">);</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="dt">uint16_t</span> searchForwardForExternalValue<span class="op">(</span><span class="dt">uint16_t</span> address<span class="op">,</span> <span class="dt">uint8_t</span> value<span class="op">,</span> <span class="dt">bool</span><span class="op">*</span> success<span class="op">);</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="dt">uint16_t</span> searchBackwardForExternalValue<span class="op">(</span><span class="dt">uint16_t</span> address<span class="op">,</span> <span class="dt">uint8_t</span> value<span class="op">,</span> <span class="dt">bool</span><span class="op">*</span> success<span class="op">);</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="dt">uint16_t</span> countValueInRange<span class="op">(</span><span class="dt">uint16_t</span> startAddress<span class="op">,</span> <span class="dt">uint16_t</span> endAddress<span class="op">,</span> <span class="dt">uint8_t</span> value<span class="op">);</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span></code></pre></div>
<div class="sourceCode" id="cb28" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#ifndef MENU_H</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MENU_H</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> titleScreen<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> fryScreen<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> menu<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> blockSizeMenu<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span></code></pre></div>
<div class="sourceCode" id="cb29" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#ifndef MOVE_H</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MOVE_H</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> move<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span></code></pre></div>
<div class="sourceCode" id="cb30" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#ifndef RTC_H</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define RTC_H</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#define RTC_ADDRESS </span><span class="bn">0x0000</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_SECONDS_REG__                 </span>RTC_ADDRESS<span class="pp"> </span><span class="op">+</span><span class="pp"> </span><span class="op">(</span><span class="bn">0x00</span><span class="pp"> </span><span class="op">&lt;&lt;</span><span class="pp"> </span><span class="dv">9</span><span class="op">)</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_MINUTES_REG__                 </span>RTC_ADDRESS<span class="pp"> </span><span class="op">+</span><span class="pp"> </span><span class="op">(</span><span class="bn">0x01</span><span class="pp"> </span><span class="op">&lt;&lt;</span><span class="pp"> </span><span class="dv">9</span><span class="op">)</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_HOURS_REG__                	</span>RTC_ADDRESS<span class="pp"> </span><span class="op">+</span><span class="pp"> </span><span class="op">(</span><span class="bn">0x02</span><span class="pp"> </span><span class="op">&lt;&lt;</span><span class="pp"> </span><span class="dv">9</span><span class="op">)</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_DAYS_REG__ 		            </span>RTC_ADDRESS<span class="pp"> </span><span class="op">+</span><span class="pp"> </span><span class="op">(</span><span class="bn">0x03</span><span class="pp"> </span><span class="op">&lt;&lt;</span><span class="pp"> </span><span class="dv">9</span><span class="op">)</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_DATE_REG__        	        </span>RTC_ADDRESS<span class="pp"> </span><span class="op">+</span><span class="pp"> </span><span class="op">(</span><span class="bn">0x04</span><span class="pp"> </span><span class="op">&lt;&lt;</span><span class="pp"> </span><span class="dv">9</span><span class="op">)</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_MONTH_REG__           	    </span>RTC_ADDRESS<span class="pp"> </span><span class="op">+</span><span class="pp"> </span><span class="op">(</span><span class="bn">0x05</span><span class="pp"> </span><span class="op">&lt;&lt;</span><span class="pp"> </span><span class="dv">9</span><span class="op">)</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_YEAR_REG__                	</span>RTC_ADDRESS<span class="pp"> </span><span class="op">+</span><span class="pp"> </span><span class="op">(</span><span class="bn">0x06</span><span class="pp"> </span><span class="op">&lt;&lt;</span><span class="pp"> </span><span class="dv">9</span><span class="op">)</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_CENTURY_REG__                	</span>RTC_ADDRESS<span class="pp"> </span><span class="op">+</span><span class="pp"> </span><span class="op">(</span><span class="bn">0x07</span><span class="pp"> </span><span class="op">&lt;&lt;</span><span class="pp"> </span><span class="dv">9</span><span class="op">)</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_ALARM_SEC_REG__               </span>RTC_ADDRESS<span class="pp"> </span><span class="op">+</span><span class="pp"> </span><span class="op">(</span><span class="bn">0x08</span><span class="pp"> </span><span class="op">&lt;&lt;</span><span class="pp"> </span><span class="dv">9</span><span class="op">)</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_ALARM_MIN_REG__               </span>RTC_ADDRESS<span class="pp"> </span><span class="op">+</span><span class="pp"> </span><span class="op">(</span><span class="bn">0x09</span><span class="pp"> </span><span class="op">&lt;&lt;</span><span class="pp"> </span><span class="dv">9</span><span class="op">)</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_ALARM_HOUR_REG__              </span>RTC_ADDRESS<span class="pp"> </span><span class="op">+</span><span class="pp"> </span><span class="op">(</span><span class="bn">0x0A</span><span class="pp"> </span><span class="op">&lt;&lt;</span><span class="pp"> </span><span class="dv">9</span><span class="op">)</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_ALARM_DAY_REG__               </span>RTC_ADDRESS<span class="pp"> </span><span class="op">+</span><span class="pp"> </span><span class="op">(</span><span class="bn">0x0B</span><span class="pp"> </span><span class="op">&lt;&lt;</span><span class="pp"> </span><span class="dv">9</span><span class="op">)</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_WATCHDOG1_REG__               </span>RTC_ADDRESS<span class="pp"> </span><span class="op">+</span><span class="pp"> </span><span class="op">(</span><span class="bn">0x0C</span><span class="pp"> </span><span class="op">&lt;&lt;</span><span class="pp"> </span><span class="dv">9</span><span class="op">)</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_WATCHDOG2_REG__               </span>RTC_ADDRESS<span class="pp"> </span><span class="op">+</span><span class="pp"> </span><span class="op">(</span><span class="bn">0x0D</span><span class="pp"> </span><span class="op">&lt;&lt;</span><span class="pp"> </span><span class="dv">9</span><span class="op">)</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_CTRL_A_REG__                  </span>RTC_ADDRESS<span class="pp"> </span><span class="op">+</span><span class="pp"> </span><span class="op">(</span><span class="bn">0x0E</span><span class="pp"> </span><span class="op">&lt;&lt;</span><span class="pp"> </span><span class="dv">9</span><span class="op">)</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_CTRL_B_REG__                  </span>RTC_ADDRESS<span class="pp"> </span><span class="op">+</span><span class="pp"> </span><span class="op">(</span><span class="bn">0x0F</span><span class="pp"> </span><span class="op">&lt;&lt;</span><span class="pp"> </span><span class="dv">9</span><span class="op">)</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_RAM_ADDR_REG__				</span>RTC_ADDRESS<span class="pp"> </span><span class="op">+</span><span class="pp"> </span><span class="op">(</span><span class="bn">0x10</span><span class="pp"> </span><span class="op">&lt;&lt;</span><span class="pp"> </span><span class="dv">9</span><span class="op">)</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_EXT_RAM_ADDR_REG__			</span>RTC_ADDRESS<span class="pp"> </span><span class="op">+</span><span class="pp"> </span><span class="op">(</span><span class="bn">0x13</span><span class="pp"> </span><span class="op">&lt;&lt;</span><span class="pp"> </span><span class="dv">9</span><span class="op">)</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a><span class="co">// Control A Register Values</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __CTRLA_WDF_SET__		</span><span class="bn">0x02</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __CTRLA_KSF_SET__ 		</span><span class="bn">0x04</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __CTRLA_TDF_SET__ 		</span><span class="bn">0x08</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __CTRLA_PAB_SET__		</span><span class="bn">0x10</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __CTRLA_PRS_SET__		</span><span class="bn">0x20</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a><span class="co">// Control B Register Values</span></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __CTRLB_WDS_SET__ 		</span><span class="bn">0x01</span></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __CTRLB_WDE_SET__ 		</span><span class="bn">0x02</span></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __CTRLB_KIE_SET__ 		</span><span class="bn">0x04</span></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __CTRLB_TIE_SET__ 		</span><span class="bn">0x08</span></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __CTRLB_TPE_SET__ 		</span><span class="bn">0x10</span></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __CTRLB_BME_SET__ 		</span><span class="bn">0x20</span></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __CTRLB_CS_SET__ 		</span><span class="bn">0x40</span></span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __CTRLB_TE_SET__ 		</span><span class="bn">0x80</span></span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a><span class="co">//Month Control Bits</span></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __MON_EOSC_SET__ 		</span><span class="bn">0x80</span></span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __MON_E32K_SET__ 		</span><span class="bn">0x40</span></span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __MON_BB32_SET__ 		</span><span class="bn">0x20</span></span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a><span class="co">//Masks</span></span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_MONTH_MASK__ 		</span><span class="bn">0x1F</span></span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_DATE_MASK__ 		</span><span class="bn">0x3F</span></span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_SECONDS_MASK__  	</span><span class="bn">0x7F</span></span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_MINUTES_MASK__    </span><span class="bn">0x7F</span></span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_HOURS_MASK__		</span><span class="bn">0x3F</span></span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_DAYS_MASK__		</span><span class="bn">0x07</span></span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_YEAR_MASK__		</span><span class="bn">0xFF</span></span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a><span class="pp">#define __RTC_CENTURY_MASK__	</span><span class="bn">0xFF</span></span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a><span class="co">// void rtcInit(void);</span></span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> rtcBcdToAscii<span class="op">(</span><span class="dt">uint8_t</span> bcd<span class="op">);</span></span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> rtcAsciiToBcd<span class="op">(</span><span class="dt">uint8_t</span> ascii<span class="op">);</span></span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> rtcRegToLCD<span class="op">(</span><span class="dt">uint8_t</span> __xdata <span class="op">*</span> reg<span class="op">,</span> <span class="dt">uint8_t</span> mask<span class="op">);</span></span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-67"><a href="#cb30-67" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> rtcPrint<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb30-68"><a href="#cb30-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-69"><a href="#cb30-69" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> rtcMenu<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb30-70"><a href="#cb30-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-71"><a href="#cb30-71" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span></code></pre></div>
<div class="sourceCode" id="cb31" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#ifndef RAMCHECK_H</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define RAMCHECK_H</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;Bool.h&quot;</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> writeAllRam<span class="op">(</span><span class="dt">uint8_t</span> value<span class="op">);</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> readAllRam<span class="op">(</span><span class="dt">uint8_t</span> value<span class="op">);</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> ramCheckCycle<span class="op">(</span><span class="dt">uint8_t</span> value<span class="op">);</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> ramCheck<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span></code></pre></div>
<div class="sourceCode" id="cb32" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#ifndef SEG_H</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define SEG_H</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#define SEG_7_ADDRESS </span><span class="bn">0x8000</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;8051.h&gt;</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> hexToSegment<span class="op">(</span><span class="dt">uint8_t</span> byte<span class="op">);</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> loadingLoop<span class="op">(</span><span class="dt">uint8_t</span> count<span class="op">);</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span></code></pre></div>
<div class="sourceCode" id="cb33" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#ifndef SERIAL_H</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define SERIAL_H</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;8051.h&quot;</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> serialInit<span class="op">(</span><span class="dt">void</span><span class="op">);</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span></code></pre></div>
<div class="sourceCode" id="cb34" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#ifndef UTILS_H</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define UTILS_H</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> printHexByteToASCIIArray<span class="op">(</span><span class="dt">uint8_t</span> byte<span class="op">);</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> printHexWordToASCIIArray<span class="op">(</span><span class="dt">uint16_t</span> word<span class="op">);</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> <span class="op">*</span> hexByteToASCIIArray<span class="op">(</span><span class="dt">uint8_t</span> byte<span class="op">);</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span><span class="op">*</span> hexWordToASCIIArray<span class="op">(</span><span class="dt">uint16_t</span> word<span class="op">);</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> iowrite8<span class="op">(</span><span class="dt">uint8_t</span> __xdata<span class="op">*</span> map_address<span class="op">,</span> <span class="dt">uint8_t</span> d<span class="op">);</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">uint8_t</span> ioread8<span class="op">(</span><span class="dt">uint8_t</span> __xdata<span class="op">*</span> map_address<span class="op">);</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span></code></pre></div>
<h2 id="implementation-code-for-pld">Implementation Code for PLD</h2>
<div class="sourceCode" id="cb35" data-language="c"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">/****** INPUT PINS ******/</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>PIN <span class="dv">2</span> <span class="op">=</span> iom<span class="op">;</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>PIN <span class="dv">3</span> <span class="op">=</span> psen<span class="op">;</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>PIN <span class="dv">4</span> <span class="op">=</span> wr<span class="op">;</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>PIN <span class="dv">5</span> <span class="op">=</span> a15<span class="op">;</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>PIN <span class="dv">6</span> <span class="op">=</span> a14<span class="op">;</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="co">/****** OUTPUT PINS ******/</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>PIN <span class="dv">19</span> <span class="op">=</span> cs_rom1<span class="op">;</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>PIN <span class="dv">18</span> <span class="op">=</span> cs_rom2<span class="op">;</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>PIN <span class="dv">17</span> <span class="op">=</span> cs_ram1<span class="op">;</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>PIN <span class="dv">16</span> <span class="op">=</span> cs_ram2<span class="op">;</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>PIN <span class="dv">15</span> <span class="op">=</span> cs_adc<span class="op">;</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>PIN <span class="dv">14</span> <span class="op">=</span> cs_lcd<span class="op">;</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>PIN <span class="dv">13</span> <span class="op">=</span> cd_rtc<span class="op">;</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>PIN <span class="dv">12</span> <span class="op">=</span> cs_seg<span class="op">;</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>cs_rom1 <span class="op">=</span> <span class="op">!(!</span>psen <span class="op">&amp;</span> <span class="op">!</span>iom <span class="op">&amp;</span> <span class="op">!</span>a15<span class="op">);</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>cs_rom2 <span class="op">=</span> <span class="op">!(!</span>psen <span class="op">&amp;</span> <span class="op">!</span>iom <span class="op">&amp;</span> a15<span class="op">);</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>cs_ram1 <span class="op">=</span> <span class="op">!(</span>psen <span class="op">&amp;</span> <span class="op">!</span>iom <span class="op">&amp;</span> <span class="op">!</span>a15<span class="op">);</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>cs_ram2 <span class="op">=</span> <span class="op">!(</span>psen <span class="op">&amp;</span> <span class="op">!</span>iom <span class="op">&amp;</span> a15<span class="op">);</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>cs_adc <span class="op">=</span> <span class="op">!(</span>psen <span class="op">&amp;</span> iom <span class="op">&amp;</span> a15 <span class="op">&amp;</span> a14<span class="op">);</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>cs_lcd <span class="op">=</span> <span class="op">!(</span>psen <span class="op">&amp;</span> iom <span class="op">&amp;</span> <span class="op">!</span>a15 <span class="op">&amp;</span> a14<span class="op">);</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>cd_rtc <span class="op">=</span> <span class="op">!(</span>psen <span class="op">&amp;</span> iom <span class="op">&amp;</span> <span class="op">!</span>a15 <span class="op">&amp;</span> <span class="op">!</span>a14<span class="op">);</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>cs_seg <span class="op">=</span> <span class="op">(</span>psen <span class="op">&amp;</span> iom <span class="op">&amp;</span> a15 <span class="op">&amp;</span> <span class="op">!</span>a14 <span class="op">&amp;</span> <span class="op">!</span>wr<span class="op">);</span></span></code></pre></div>
</body>
</html>
